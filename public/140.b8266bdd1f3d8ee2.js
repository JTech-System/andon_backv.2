"use strict";(self.webpackChunkandon_frontend=self.webpackChunkandon_frontend||[]).push([[140],{4140:(ht,b,i)=>{i.r(b),i.d(b,{GroupsModule:()=>gt});var f=i(1303),h=i(5861),m=i(6223),T=i(6510),S=i(7921),D=i(7398),t=i(5879),Z=i(4808),I=i(2186),c=i(6814),J=i(3680),L=i(5986),C=i(8034),d=i(5683),A=i(2032),O=i(8525),g=i(5195),G=i(4104),y=i(2296),F=i(300),U=i(3031);function M(e,n){1&e&&(t.TgZ(0,"div",31),t._uU(1," Name is required. "),t.qZA())}function Q(e,n){if(1&e&&(t.TgZ(0,"mat-hint",29),t.YNc(1,M,2,0,"div",30),t.qZA()),2&e){const a=t.oxw();t.xp6(1),t.Q6J("ngIf",a.f.name.errors&&a.f.name.errors.required)}}function k(e,n){if(1&e){const a=t.EpF();t.TgZ(0,"mat-option",32),t.NdJ("click",function(){const s=t.CHM(a).$implicit,u=t.oxw();return t.KtG(u.manager_id=s.id||"")}),t._uU(1),t.ALo(2,"fullName"),t.qZA()}if(2&e){const a=n.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",t.lcZ(2,2,a),"")}}function Y(e,n){if(1&e){const a=t.EpF();t.TgZ(0,"mat-card",0)(1,"mat-tab-group",33)(2,"mat-tab",34)(3,"mat-card-content")(4,"div",35)(5,"div",36)(6,"app-m2m",37),t.NdJ("relationshipChanged",function(r){t.CHM(a);const s=t.oxw();return t.KtG(s.onChanged(r))}),t.qZA()()()()()()()}if(2&e){const a=t.oxw();t.xp6(6),t.Q6J("m2mData",a.m2mRoles)}}let q=(()=>{var e;class n{constructor(o,r,s,u,_){var l=this;this._formBuilder=o,this.groupsService=r,this.route=s,this.router=u,this.usersService=_,this.groups=[],this.rolesIds=[],this.createdOn=new Date,this.group_id="",this.newRecord=!0,this.filterControl=new m.NI(""),this.usersFilter=[],this.manager_id="",this.failed=!1,this.groupForm=this._formBuilder.group({name:["",[m.kI.required,m.kI.minLength(2)]],manager:new m.NI(""),isActive:[!0],description:new m.NI("")}),this.route.queryParams.subscribe(function(){var ft=(0,h.Z)(function*(N){l.group_id=N.id,l.group_id&&(l.group=yield l.groupsService.findOne(l.group_id),l.group&&(l.createdOn=new Date(l.group.createdOn),l.groupForm.patchValue(l.group),l.groupForm.controls.manager.patchValue(l.group.manager?l.group.manager.id:""),l.rolesIds=l.group.roles.map(v=>v.id),l.roles=l.group.roles.map(v=>({parent:l.group.id,relation:v.name,relation_id:v.id})),l.setM2MData(),l.newRecord=!1))});return function(N){return ft.apply(this,arguments)}}())}setM2MData(){this.m2mRoles={title:"Roles",titleSingle:"Rol",parent:this.group.id,parent_table:"group",relation:"roles",rel_primary_col:"name",relation_endpoint:T.S.ROLES.BASE_ENDPOINT,display_cols:["name"],updateRelationEndpoint:T.S.GROUPS.UPDATE_ROLES,data:this.roles}}ngOnInit(){var o=this;return(0,h.Z)(function*(){const r=yield o.usersService.findAll();r&&(o.usersFilter=r),o.searchfilteredOptions=o.filterControl.valueChanges.pipe((0,S.O)(""),(0,D.U)(s=>o._searchfilter(s||"")))})()}get f(){return this.groupForm.controls}onSubmit(){var o=this;return(0,h.Z)(function*(){o.groupForm.invalid?o.failed=!0:(""!=o.groupForm.get("manager")?.value&&o.groupForm.get("manager")?.patchValue(o.manager_id),o.group=o.group_id&&!o.newRecord?yield o.groupsService.updateGroup(o.group.id,o.groupForm.value):yield o.groupsService.create(o.groupForm.value),o.group&&(o.failed=!1,o.router.navigate(["/groups"])))})()}onChanged(o){}_searchfilter(o){const r=o.toLowerCase();return this.usersFilter.filter(s=>s.username.toString().toLowerCase().includes(r))}}return(e=n).\u0275fac=function(o){return new(o||e)(t.Y36(m.qu),t.Y36(Z.J),t.Y36(f.gz),t.Y36(f.F0),t.Y36(I.f))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-group"]],decls:50,vars:13,consts:[[1,"cardWithShadow","theme-card"],[1,"w-100","row","justify-content-end"],[1,"col-8"],[1,"m-10"],[1,"col-4","justify-content-end"],[1,"col-4","justify-content-end","img-bg-group-icon"],[1,"b-t-1"],[3,"formGroup"],[1,"row","m-t-20","justify-content-start","m-l-20"],[1,"col-sm-5"],[1,"mat-subtitle-2","f-w-600","m-b-8","d-block"],["appearance","outline","color","primary",1,"w-100"],["matInput","","type","text","placeholder","IT","formControlName","name"],["class","m-b-16 error-msg",4,"ngIf"],["appearance","outline",1,"w-100"],["matInput","","placeholder","MM/DD/AAAA","disabled","",3,"matDatepicker","value"],["matIconSuffix","",3,"for"],["picker",""],["formControlName","manager"],[3,"value"],[3,"value","click",4,"ngFor","ngForOf"],[1,"mat-subtitle-2","f-w-600","m-b-8","d-block","m-t-12"],["color","primary","checked","","formControlName","isActive"],[1,"col-sm-10"],["matInput","","rows","5","formControlName","description","placeholder","A group for IT Support"],["class","cardWithShadow theme-card",4,"ngIf"],[1,"m-t-12","text-right"],["mat-flat-button","","color","accent",1,"m-2"],["type","submit","mat-flat-button","","color","primary",1,"m-2",3,"click"],[1,"m-b-16","error-msg"],["class","text-error",4,"ngIf"],[1,"text-error"],[3,"value","click"],["mat-stretch-tabs","false","mat-align-tabs","start","animationDuration","0ms"],["label","Roles"],[1,"row"],[1,"col-12"],[3,"m2mData","relationshipChanged"]],template:function(o,r){if(1&o&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header",1)(2,"div",2)(3,"mat-card-title",3),t._uU(4),t.qZA()(),t._UZ(5,"div",4),t.qZA(),t._UZ(6,"div",5),t.TgZ(7,"mat-card-content",6)(8,"form",7)(9,"div",8)(10,"div",9)(11,"mat-label",10),t._uU(12,"Nombre"),t.TgZ(13,"span"),t._uU(14,"*"),t.qZA()(),t.TgZ(15,"mat-form-field",11),t._UZ(16,"input",12),t.YNc(17,Q,2,1,"mat-hint",13),t.qZA()(),t.TgZ(18,"div",9)(19,"mat-label",10),t._uU(20,"Creado"),t.qZA(),t.TgZ(21,"mat-form-field",14),t._UZ(22,"input",15)(23,"mat-datepicker-toggle",16)(24,"mat-datepicker",null,17),t.qZA()(),t.TgZ(26,"div",9)(27,"mat-label"),t._uU(28,"L\xedder de Grupo"),t.qZA(),t.TgZ(29,"mat-form-field",14)(30,"mat-select",18)(31,"mat-option",19),t._uU(32,"-- Nadie --"),t.qZA(),t.YNc(33,k,3,4,"mat-option",20),t.ALo(34,"async"),t.qZA()()(),t.TgZ(35,"div",9)(36,"mat-label",21),t._uU(37," Activo "),t.qZA(),t._UZ(38,"mat-checkbox",22),t.qZA(),t.TgZ(39,"div",23)(40,"mat-label",10),t._uU(41,"Descripcion"),t.qZA(),t.TgZ(42,"mat-form-field",11),t._UZ(43,"textarea",24),t.qZA()()(),t.YNc(44,Y,7,1,"mat-card",25),t.TgZ(45,"div",26)(46,"button",27),t._uU(47,"Cancel"),t.qZA(),t.TgZ(48,"button",28),t.NdJ("click",function(){return r.onSubmit()}),t._uU(49," Submit "),t.qZA()()()()()),2&o){const s=t.MAs(25);let u;t.xp6(4),t.Oqu(r.newRecord?"Crear Nuevo":r.group.name),t.xp6(4),t.Q6J("formGroup",r.groupForm),t.xp6(5),t.ekj("text-error",null==(u=r.groupForm.get("name"))?null:u.hasError("required")),t.xp6(4),t.Q6J("ngIf",r.f.name.touched&&r.f.name.invalid||r.failed),t.xp6(5),t.Q6J("matDatepicker",s)("value",r.createdOn),t.xp6(1),t.Q6J("for",s),t.xp6(8),t.Q6J("value",""),t.xp6(2),t.Q6J("ngForOf",t.lcZ(34,11,r.searchfilteredOptions)),t.xp6(11),t.Q6J("ngIf",!r.newRecord)}},dependencies:[c.sg,c.O5,J.ey,L.oG,C.Mq,C.hl,C.nW,d.KE,d.hX,d.bx,d.R9,A.Nt,O.gD,g.a8,g.dn,g.dk,g.n5,G.uX,G.SP,y.lW,m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u,F.I,c.Ov,U.k],styles:[".img-bg-group-icon[_ngcontent-%COMP%]{background-image:url(engineers-working-02.1861c7f3cc7b8f44.png);background-size:80px;background-repeat:no-repeat;background-position:right;right:20px;top:-20px;position:absolute;min-height:100px}"]}),n})();var w=i(1476),x=i(3566),j=i(617),E=i(5940),p=i(5313);function z(e,n){1&e&&t._UZ(0,"mat-spinner")}function B(e,n){1&e&&(t.TgZ(0,"div",41),t._uU(1," Andon's API rate limit has been reached. It will be reset in one minute. "),t.qZA())}function H(e,n){if(1&e&&(t.TgZ(0,"div",38),t.YNc(1,z,1,0,"mat-spinner",39),t.YNc(2,B,2,0,"div",40),t.qZA()),2&e){const a=t.oxw();t.xp6(1),t.Q6J("ngIf",a.isLoadingResults),t.xp6(1),t.Q6J("ngIf",a.isRateLimitReached)}}function P(e,n){1&e&&(t.TgZ(0,"th",42),t._uU(1," Nombre "),t.qZA())}function V(e,n){if(1&e&&(t.TgZ(0,"td",43),t._uU(1),t.qZA()),2&e){const a=n.$implicit;t.xp6(1),t.hij(" ",a.name.slice(0,50)," ")}}function W(e,n){1&e&&(t.TgZ(0,"th",44),t._uU(1," Manager "),t.qZA())}const K=function(){return["/users/user"]},R=function(e){return{id:e}};function $(e,n){if(1&e&&(t.TgZ(0,"td",43)(1,"a",45),t._uU(2),t.ALo(3,"fullName"),t.qZA()()),2&e){const a=n.$implicit;t.xp6(1),t.Q6J("routerLink",t.DdM(5,K))("queryParams",t.VKq(6,R,a.manager?a.manager.id:"#")),t.xp6(1),t.hij(" ",a.manager?t.lcZ(3,3,a.manager):""," ")}}function X(e,n){1&e&&(t.TgZ(0,"th",46),t._uU(1," Created "),t.qZA())}function tt(e,n){if(1&e&&(t.TgZ(0,"td",47)(1,"div",48)(2,"mat-icon",49),t._uU(3,"calendar_today"),t.qZA(),t._uU(4),t.ALo(5,"date"),t.qZA()()),2&e){const a=n.$implicit;t.xp6(4),t.hij(" ",t.lcZ(5,1,a.createdOn)," ")}}function et(e,n){1&e&&(t.TgZ(0,"th",50),t._uU(1," Action "),t.qZA())}const ot=function(){return["/groups/group"]};function rt(e,n){if(1&e){const a=t.EpF();t.TgZ(0,"td",51)(1,"a",45)(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"a",52),t.NdJ("click",function(){const s=t.CHM(a).$implicit,u=t.oxw();return t.KtG(u.remove(s.id))}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}if(2&e){const a=n.$implicit;t.xp6(1),t.Q6J("routerLink",t.DdM(2,ot))("queryParams",t.VKq(3,R,a.id))}}function at(e,n){1&e&&t._UZ(0,"tr",53)}function nt(e,n){1&e&&t._UZ(0,"tr",54)}const it=function(){return["/","groups","group"]},st=function(){return[10,25,50,100]},lt=[{path:"",component:(()=>{var e;class n{constructor(o){this.groupsService=o,this.displayedColumns=["createdOn","name","manager","action"],this.groups=[],this.resultsLength=0,this.isLoadingResults=!0,this.isRateLimitReached=!1,this.paginator=Object.create(null),this.sort=Object.create(null)}ngAfterViewInit(){var o=this;return(0,h.Z)(function*(){o.loadGroups(),o.sort.sortChange.subscribe(()=>{o.paginator.pageIndex=0,o.loadGroups()}),o.paginator.page.subscribe(()=>o.loadGroups())})()}loadGroups(o=""){const r=this.paginator.pageIndex*this.paginator.pageSize,s=this.paginator.pageSize,u=this.sort.active,_=this.sort.direction;this.isLoadingResults=!0,this.groupsService.findAllFilters(r,s,u,_,o).then(l=>{this.groups=l.rows,this.resultsLength=l.row_count,this.isLoadingResults=!1,this.isRateLimitReached=!1}).catch(()=>{this.isLoadingResults=!1,this.isRateLimitReached=!0,this.groups=[]})}applyFilter(o){this.loadGroups(o.target.value)}remove(o){var r=this;return(0,h.Z)(function*(){yield r.groupsService.delete(o),r.groups=r.groups.filter(s=>s.id!==o)})()}}return(e=n).\u0275fac=function(o){return new(o||e)(t.Y36(Z.J))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-groups"]],viewQuery:function(o,r){if(1&o&&(t.Gf(w.NW,5),t.Gf(x.YE,5)),2&o){let s;t.iGM(s=t.CRH())&&(r.paginator=s.first),t.iGM(s=t.CRH())&&(r.sort=s.first)}},decls:44,vars:10,consts:[[1,"bg-light-primary","rounded","p-y-7","p-x-24","m-b-20","overflow-hidden"],[1,"row"],[1,"col-sm-12"],["aria-label","breadcrumb",1,"m-5"],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item","page-title","m-0","f-s-14","p-t-4","f-w-600","m-b-5"],[1,"breadcrumb-item","active","m-0","f-s-14","p-t-4","f-w-600","m-b-5"],[1,"col-4","justify-content-end","img-bg-groups-icon"],[1,"cardWithShadow"],[1,"p-24"],[1,"row","justify-content-between"],[1,"col-lg-4"],[1,"text-2xl","font-bold"],["appearance","outline",1,"w-100","hide-hint"],["matInput","","placeholder","Buscar Roles",3,"keyup"],["matSuffix",""],["name","search",1,"icon-20"],[1,"col-lg-4","justify-content-end"],[1,"row","justify-content-end","m-b-6"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"example-container","m-t-30"],["class","example-loading-shade",4,"ngIf"],[1,"example-table-container","responsive-table"],["mat-table","","matSort","","matSortActive","createdOn","matSortDisableClear","","matSortDirection","desc",1,"example-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","f-w-600 mat-subtitle-1 f-s-16",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","manager"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-16",4,"matHeaderCellDef"],["matColumnDef","createdOn"],["mat-header-cell","","mat-sort-header","","disableClear","","class","f-w-600 mat-subtitle-1 f-s-16 p-l-0",4,"matHeaderCellDef"],["mat-cell","","class","p-l-0",4,"matCellDef"],["matColumnDef","action"],["mat-header-cell","","class","f-s-16 f-w-600",4,"matHeaderCellDef"],["mat-cell","","class","action-link",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize","pageSizeOptions"],[1,"example-loading-shade"],[4,"ngIf"],["class","example-rate-limit-reached",4,"ngIf"],[1,"example-rate-limit-reached"],["mat-header-cell","","mat-sort-header","",1,"f-w-600","mat-subtitle-1","f-s-16"],["mat-cell",""],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-16"],[1,"m-r-10","cursor-pointer",3,"routerLink","queryParams"],["mat-header-cell","","mat-sort-header","","disableClear","",1,"f-w-600","mat-subtitle-1","f-s-16","p-l-0"],["mat-cell","",1,"p-l-0"],[1,"d-flex","align-items-center","gap-8"],[1,"text-sm"],["mat-header-cell","",1,"f-s-16","f-w-600"],["mat-cell","",1,"action-link"],[1,"m-r-10","cursor-pointer",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,r){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"nav",3)(4,"ol",4)(5,"li",5),t._uU(6," Usuarios "),t.qZA(),t.TgZ(7,"li",6),t._uU(8," Grupos "),t.qZA()()()()(),t._UZ(9,"i",7),t.qZA(),t.TgZ(10,"mat-card",8)(11,"mat-card-content",9)(12,"div",10)(13,"div",11)(14,"h1",12),t._uU(15,"Grupos"),t.qZA(),t.TgZ(16,"mat-form-field",13)(17,"input",14),t.NdJ("keyup",function(u){return r.applyFilter(u)}),t.qZA(),t.TgZ(18,"mat-icon",15)(19,"mat-icon",16),t._uU(20,"search"),t.qZA()()()(),t.TgZ(21,"div",17)(22,"div",18)(23,"button",19),t._uU(24," Crear Grupo "),t.qZA()()()(),t.TgZ(25,"div",20),t.YNc(26,H,3,2,"div",21),t.TgZ(27,"div",22)(28,"table",23),t.ynx(29,24),t.YNc(30,P,2,0,"th",25),t.YNc(31,V,2,1,"td",26),t.BQk(),t.ynx(32,27),t.YNc(33,W,2,0,"th",28),t.YNc(34,$,4,8,"td",26),t.BQk(),t.ynx(35,29),t.YNc(36,X,2,0,"th",30),t.YNc(37,tt,6,3,"td",31),t.BQk(),t.ynx(38,32),t.YNc(39,et,2,0,"th",33),t.YNc(40,rt,7,5,"td",34),t.BQk(),t.YNc(41,at,1,0,"tr",35),t.YNc(42,nt,1,0,"tr",36),t.qZA()(),t._UZ(43,"mat-paginator",37),t.qZA()()()),2&o&&(t.xp6(23),t.Q6J("routerLink",t.DdM(8,it)),t.xp6(3),t.Q6J("ngIf",r.isLoadingResults||r.isRateLimitReached),t.xp6(2),t.Q6J("dataSource",r.groups),t.xp6(13),t.Q6J("matHeaderRowDef",r.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",r.displayedColumns),t.xp6(1),t.Q6J("length",r.resultsLength)("pageSize",10)("pageSizeOptions",t.DdM(9,st)))},dependencies:[c.O5,f.rH,d.KE,d.R9,A.Nt,g.a8,g.dn,y.lW,j.Hw,E.Ou,w.NW,x.YE,x.nU,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,c.uU,U.k],styles:[".img-bg-groups-icon[_ngcontent-%COMP%]{background-image:url(employee01.4b7a127a270e309d.png);background-size:100px;background-repeat:no-repeat;background-position:right;right:30px;top:55px;position:absolute;min-height:100px}"]}),n})()},{path:"group",component:q}];let mt=(()=>{var e;class n{}return(e=n).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[f.Bz.forChild(lt),f.Bz]}),n})();var ut=i(1186),pt=i(6208),ct=i(2577),dt=i(2524);let gt=(()=>{var e;class n{}return(e=n).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[Z.J,c.uU],imports:[c.ez,mt,ut.q,m.u5,m.UX,pt.m,ct.UsersModule,dt.D]}),n})()}}]);