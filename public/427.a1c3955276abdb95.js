"use strict";(self.webpackChunkandon_frontend=self.webpackChunkandon_frontend||[]).push([[427],{9427:(w,Z,r)=>{r.r(Z),r.d(Z,{RolesModule:()=>oe});var d=r(6814),u=r(1303),_=r(5861),b=r(1476),C=r(3566),e=r(5879),R=r(9645),v=r(5683),m=r(2032),c=r(5195),g=r(2296),y=r(617),T=r(5940),p=r(5313);function A(t,a){1&t&&e._UZ(0,"mat-spinner")}function U(t,a){1&t&&(e.TgZ(0,"div",39),e._uU(1," Andon's API rate limit has been reached. It will be reset in one minute. "),e.qZA())}function E(t,a){if(1&t&&(e.TgZ(0,"div",36),e.YNc(1,A,1,0,"mat-spinner",37),e.YNc(2,U,2,0,"div",38),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.isLoadingResults),e.xp6(1),e.Q6J("ngIf",i.isRateLimitReached)}}function L(t,a){1&t&&(e.TgZ(0,"th",40),e._uU(1," Nombre "),e.qZA())}function P(t,a){if(1&t&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&t){const i=a.$implicit;e.xp6(1),e.hij(" ",i.name.slice(0,50)," ")}}function N(t,a){1&t&&(e.TgZ(0,"th",42),e._uU(1," Created "),e.qZA())}function F(t,a){if(1&t&&(e.TgZ(0,"td",43)(1,"div",44)(2,"mat-icon",45),e._uU(3,"calendar_today"),e.qZA(),e._uU(4),e.ALo(5,"date"),e.qZA()()),2&t){const i=a.$implicit;e.xp6(4),e.hij(" ",e.lcZ(5,1,i.createdOn)," ")}}function J(t,a){1&t&&(e.TgZ(0,"th",46),e._uU(1," Action "),e.qZA())}const Y=function(){return["/roles/role"]},Q=function(t){return{id:t}};function B(t,a){if(1&t){const i=e.EpF();e.TgZ(0,"td",47)(1,"a",48)(2,"mat-icon"),e._uU(3,"edit"),e.qZA()(),e.TgZ(4,"a",49),e.NdJ("click",function(){const l=e.CHM(i).$implicit,f=e.oxw();return e.KtG(f.remove(l.id))}),e.TgZ(5,"mat-icon"),e._uU(6,"delete"),e.qZA()()()}if(2&t){const i=a.$implicit;e.xp6(1),e.Q6J("routerLink",e.DdM(2,Y))("queryParams",e.VKq(3,Q,i.id))}}function j(t,a){1&t&&e._UZ(0,"tr",50)}function k(t,a){1&t&&e._UZ(0,"tr",51)}const z=function(){return["/","roles","role"]},q=function(){return[25,50,100]};let G=(()=>{var t;class a{constructor(n){this.rolesService=n,this.displayedColumns=["createdOn","name","action"],this.data=[],this.resultsLength=0,this.isLoadingResults=!0,this.isRateLimitReached=!1,this.paginator=Object.create(null),this.sort=Object.create(null)}ngAfterViewInit(){this.loadRoles(),this.sort.sortChange.subscribe(()=>{this.paginator.pageIndex=0,this.loadRoles()}),this.paginator.page.subscribe(()=>this.loadRoles())}loadRoles(n=""){const o=this.paginator.pageIndex*this.paginator.pageSize,l=this.paginator.pageSize,f=this.sort.active,s=this.sort.direction;this.isLoadingResults=!0,this.rolesService.findAllFilters(o,l,f,s,n).then(x=>{this.data=x.rows,this.resultsLength=x.row_count,this.isLoadingResults=!1,this.isRateLimitReached=!1}).catch(()=>{this.isLoadingResults=!1,this.isRateLimitReached=!0,this.data=[]})}applyFilter(n){this.loadRoles(n.target.value)}remove(n){var o=this;return(0,_.Z)(function*(){yield o.rolesService.delete(n),o.data=o.data.filter(l=>l.id!==n)})()}}return(t=a).\u0275fac=function(n){return new(n||t)(e.Y36(R.f))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-roles"]],viewQuery:function(n,o){if(1&n&&(e.Gf(b.NW,5),e.Gf(C.YE,5)),2&n){let l;e.iGM(l=e.CRH())&&(o.paginator=l.first),e.iGM(l=e.CRH())&&(o.sort=l.first)}},decls:41,vars:10,consts:[[1,"bg-light-primary","rounded","p-y-7","p-x-24","m-b-20","overflow-hidden"],[1,"row"],[1,"col-sm-12"],["aria-label","breadcrumb",1,"m-5"],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item","page-title","m-0","f-s-14","p-t-4","f-w-600","m-b-5"],[1,"breadcrumb-item","active","m-0","f-s-14","p-t-4","f-w-600","m-b-5"],[1,"col-4","justify-content-end","img-bg-roles-icon"],[1,"cardWithShadow"],[1,"p-24"],[1,"row","justify-content-between"],[1,"col-lg-4"],[1,"text-2xl","font-bold"],["appearance","outline",1,"w-100","hide-hint"],["matInput","","placeholder","Buscar Roles",3,"keyup"],["matSuffix",""],["name","search",1,"icon-20"],[1,"col-lg-4","justify-content-end"],[1,"row","justify-content-end","m-b-6"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"example-container","m-t-30"],["class","example-loading-shade",4,"ngIf"],[1,"example-table-container","responsive-table"],["mat-table","","matSort","","matSortActive","createdOn","matSortDisableClear","","matSortDirection","desc",1,"example-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","f-w-600 mat-subtitle-1 f-s-16",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","createdOn"],["mat-header-cell","","mat-sort-header","","disableClear","","class","f-w-600 mat-subtitle-1 f-s-16 p-l-0",4,"matHeaderCellDef"],["mat-cell","","class","p-l-0",4,"matCellDef"],["matColumnDef","action"],["mat-header-cell","","class","f-s-16 f-w-600",4,"matHeaderCellDef"],["mat-cell","","class","action-link",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize","pageSizeOptions"],[1,"example-loading-shade"],[4,"ngIf"],["class","example-rate-limit-reached",4,"ngIf"],[1,"example-rate-limit-reached"],["mat-header-cell","","mat-sort-header","",1,"f-w-600","mat-subtitle-1","f-s-16"],["mat-cell",""],["mat-header-cell","","mat-sort-header","","disableClear","",1,"f-w-600","mat-subtitle-1","f-s-16","p-l-0"],["mat-cell","",1,"p-l-0"],[1,"d-flex","align-items-center","gap-8"],[1,"text-sm"],["mat-header-cell","",1,"f-s-16","f-w-600"],["mat-cell","",1,"action-link"],[1,"m-r-10","cursor-pointer",3,"routerLink","queryParams"],[1,"m-r-10","cursor-pointer",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"nav",3)(4,"ol",4)(5,"li",5),e._uU(6," Seguridad "),e.qZA(),e.TgZ(7,"li",6),e._uU(8," Roles "),e.qZA()()()()(),e._UZ(9,"i",7),e.qZA(),e.TgZ(10,"mat-card",8)(11,"mat-card-content",9)(12,"div",10)(13,"div",11)(14,"h1",12),e._uU(15,"Roles"),e.qZA(),e.TgZ(16,"mat-form-field",13)(17,"input",14),e.NdJ("keyup",function(f){return o.applyFilter(f)}),e.qZA(),e.TgZ(18,"mat-icon",15)(19,"mat-icon",16),e._uU(20,"search"),e.qZA()()()(),e.TgZ(21,"div",17)(22,"div",18)(23,"button",19),e._uU(24," Crear Role "),e.qZA()()()(),e.TgZ(25,"div",20),e.YNc(26,E,3,2,"div",21),e.TgZ(27,"div",22)(28,"table",23),e.ynx(29,24),e.YNc(30,L,2,0,"th",25),e.YNc(31,P,2,1,"td",26),e.BQk(),e.ynx(32,27),e.YNc(33,N,2,0,"th",28),e.YNc(34,F,6,3,"td",29),e.BQk(),e.ynx(35,30),e.YNc(36,J,2,0,"th",31),e.YNc(37,B,7,5,"td",32),e.BQk(),e.YNc(38,j,1,0,"tr",33),e.YNc(39,k,1,0,"tr",34),e.qZA()(),e._UZ(40,"mat-paginator",35),e.qZA()()()),2&n&&(e.xp6(23),e.Q6J("routerLink",e.DdM(8,z)),e.xp6(3),e.Q6J("ngIf",o.isLoadingResults||o.isRateLimitReached),e.xp6(2),e.Q6J("dataSource",o.data),e.xp6(10),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(1),e.Q6J("length",o.resultsLength)("pageSize",10)("pageSizeOptions",e.DdM(9,q)))},dependencies:[d.O5,u.rH,v.KE,v.R9,m.Nt,c.a8,c.dn,g.lW,y.Hw,T.Ou,b.NW,C.YE,C.nU,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,d.uU],styles:[".example-container[_ngcontent-%COMP%]{position:relative;min-height:200px}.example-table-container[_ngcontent-%COMP%]{position:relative;max-height:400px;overflow:auto}.example-loading-shade[_ngcontent-%COMP%]{position:absolute;inset:0 0 56px;background:rgba(0,0,0,.15);z-index:1;display:flex;align-items:center;justify-content:center}.example-rate-limit-reached[_ngcontent-%COMP%]{color:#980000;max-width:360px;text-align:center}.mat-column-number[_ngcontent-%COMP%], .mat-column-state[_ngcontent-%COMP%]{max-width:64px}.mat-column-created[_ngcontent-%COMP%]{max-width:124px}.img-bg-roles-icon[_ngcontent-%COMP%]{background-image:url(robot01-removebg-preview.f742b791a0cf9a26.png);background-size:75px;background-repeat:no-repeat;background-position:right;right:30px;top:55px;position:absolute;min-height:100px}"]}),a})();var h=r(6223),D=r(6510),O=r(8034),I=r(4104),W=r(300);function H(t,a){1&t&&(e.TgZ(0,"div",22),e._uU(1," Name is required. "),e.qZA())}function K(t,a){if(1&t){const i=e.EpF();e.TgZ(0,"mat-card",0)(1,"mat-tab-group",23)(2,"mat-tab",24)(3,"mat-card-content")(4,"div",25)(5,"div",26)(6,"app-m2m",27),e.NdJ("relationshipChanged",function(o){e.CHM(i);const l=e.oxw();return e.KtG(l.onPermissionsChanged(o))}),e.qZA()()()()()()()}if(2&t){const i=e.oxw();e.xp6(6),e.Q6J("m2mData",i.m2mPermissions)}}const X=[{path:"",component:G},{path:"role",component:(()=>{var t;class a{constructor(n,o,l,f){var s=this;this._formBuilder=n,this.rolesService=o,this.route=l,this.router=f,this.groups=[],this.users=[],this.permissionsIds=[],this.groupsIds=[],this.usersIds=[],this.createdOn=new Date,this.role_id="",this.newRecord=!0,this.roleForm=this._formBuilder.group({name:["",[h.kI.required,h.kI.minLength(4)]]}),this.route.queryParams.subscribe(function(){var x=(0,_.Z)(function*(M){s.role_id=M.id,s.role_id&&(s.role=yield s.rolesService.findOne(s.role_id),s.role&&(s.createdOn=new Date(s.role.createdOn),s.roleForm.controls.name.setValue(s.role.name),s.permissionsIds=s.role.permissions.map(S=>S.id),s.permissions=s.role.permissions.map(S=>({parent:s.role.id,relation:S.name,relation_id:S.id})),s.setM2MData(),s.newRecord=!1))});return function(M){return x.apply(this,arguments)}}())}setM2MData(){this.m2mPermissions={title:"Permissions",titleSingle:"Permission",parent:this.role.id,parent_table:"role",relation:"permissions",rel_primary_col:"name",relation_endpoint:D.S.PERMISSIONS.BASE_ENDPOINT,display_cols:["name"],updateRelationEndpoint:D.S.ROLES.UPDATE_PERMISSIONS,data:this.permissions}}ngOnInit(){}onSubmit(){var n=this;return(0,_.Z)(function*(){n.role=n.role_id&&!n.newRecord?yield n.rolesService.updateRole(n.role.id,n.roleForm.value):yield n.rolesService.create(n.roleForm.value),n.role&&n.router.navigate(["/roles"])})()}onPermissionsChanged(n){this.permissionsIds=n,this.roleForm.get("permissions")?.patchValue(this.permissionsIds)}onUsersChanged(n){this.usersIds=n}onGroupsChanged(n){this.groupsIds=n}onRolesChanged(n){}}return(t=a).\u0275fac=function(n){return new(n||t)(e.Y36(h.qu),e.Y36(R.f),e.Y36(u.gz),e.Y36(u.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-roles"]],decls:32,vars:9,consts:[[1,"cardWithShadow","theme-card"],[1,"w-100","row","justify-content-end"],[1,"col-8"],[1,"m-10"],[1,"col-4","justify-content-end"],[1,"col-4","justify-content-end","img-bg-role-icon"],[1,"b-t-1"],[3,"formGroup","ngSubmit"],[1,"row","m-t-20"],[1,"col-sm-6"],[1,"mat-subtitle-2","f-w-600","m-b-8","d-block"],["appearance","outline","color","primary",1,"w-100"],["matInput","","type","text","placeholder","Manager IT","formControlName","name"],["class","text-error m-b-20",4,"ngIf"],["appearance","outline",1,"w-100"],["matInput","","placeholder","MM/DD/AAAA","disabled","",3,"matDatepicker","value"],["matIconSuffix","",3,"for"],["picker",""],["class","cardWithShadow theme-card",4,"ngIf"],[1,"m-t-12","text-right"],["mat-flat-button","","color","accent",1,"m-2"],["type","submit","mat-flat-button","","color","primary",1,"m-2",3,"disabled"],[1,"text-error","m-b-20"],["mat-stretch-tabs","false","mat-align-tabs","start","animationDuration","0ms"],["label","Permisos"],[1,"row"],[1,"col-12"],[3,"m2mData","relationshipChanged"]],template:function(n,o){if(1&n&&(e.TgZ(0,"mat-card",0)(1,"mat-card-header",1)(2,"div",2)(3,"mat-card-title",3),e._uU(4,"Crear Nuevo"),e.qZA()(),e._UZ(5,"div",4),e.qZA(),e._UZ(6,"div",5),e.TgZ(7,"mat-card-content",6)(8,"form",7),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(9,"div",8)(10,"div",9)(11,"mat-label",10),e._uU(12,"Nombre"),e.TgZ(13,"span"),e._uU(14,"*"),e.qZA()(),e.TgZ(15,"mat-form-field",11),e._UZ(16,"input",12),e.qZA(),e.YNc(17,H,2,0,"div",13),e.qZA(),e.TgZ(18,"div",9)(19,"mat-label",10),e._uU(20,"Created"),e.qZA(),e.TgZ(21,"mat-form-field",14),e._UZ(22,"input",15)(23,"mat-datepicker-toggle",16)(24,"mat-datepicker",null,17),e.qZA()()(),e.YNc(26,K,7,1,"mat-card",18),e.TgZ(27,"div",19)(28,"button",20),e._uU(29,"Cancel"),e.qZA(),e.TgZ(30,"button",21),e._uU(31," Submit "),e.qZA()()()()()),2&n){const l=e.MAs(25);let f,s;e.xp6(8),e.Q6J("formGroup",o.roleForm),e.xp6(5),e.ekj("text-error",null==(f=o.roleForm.get("name"))?null:f.hasError("required")),e.xp6(4),e.Q6J("ngIf",null==(s=o.roleForm.get("name"))?null:s.hasError("required")),e.xp6(5),e.Q6J("matDatepicker",l)("value",o.createdOn),e.xp6(1),e.Q6J("for",l),e.xp6(3),e.Q6J("ngIf",!o.newRecord),e.xp6(4),e.Q6J("disabled",o.roleForm.invalid)}},dependencies:[d.O5,O.Mq,O.hl,O.nW,v.KE,v.hX,v.R9,m.Nt,c.a8,c.dn,c.dk,c.n5,I.uX,I.SP,g.lW,h._Y,h.Fj,h.JJ,h.JL,h.sg,h.u,W.I],styles:[".img-bg-role-icon[_ngcontent-%COMP%]{background-image:url(icon_engineering_roles-removebg-preview.dd6f744c15e506b7.png);background-size:80px;background-repeat:no-repeat;background-position:right;right:20px;top:-20px;position:absolute;min-height:100px}"]}),a})()}];let $=(()=>{var t;class a{}return(t=a).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.Bz.forChild(X),u.Bz]}),a})();var ee=r(1186),te=r(6208),ne=r(2524);let oe=(()=>{var t;class a{}return(t=a).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[R.f,d.uU],imports:[d.ez,$,ee.q,h.u5,h.UX,ne.D,te.m]}),a})()},9645:(w,Z,r)=>{r.d(Z,{f:()=>C});var d=r(5861),u=r(6510),_=r(5879),b=r(7278);let C=(()=>{var e;class R{constructor(m){this.http=m}create(m){var c=this;return(0,d.Z)(function*(){return yield c.http.post(u.S.ROLES.BASE_ENDPOINT,m)})()}delete(m){var c=this;return(0,d.Z)(function*(){yield c.http.delete(u.S.ROLES.BY_ID(m))})()}findAll(){var m=this;return(0,d.Z)(function*(){return yield m.http.get(u.S.ROLES.BASE_ENDPOINT)})()}findAllFilters(m,c,g,y,T){var p=this;return(0,d.Z)(function*(){const A=u.S.ROLES.FILTERS(m,c,g,y,T);return yield p.http.get(A)})()}findOne(m){var c=this;return(0,d.Z)(function*(){const g=u.S.ROLES.BY_ID(m);return yield c.http.get(g)})()}updateRole(m,c){var g=this;return(0,d.Z)(function*(){return yield g.http.put(u.S.ROLES.BY_ID(m),c)})()}}return(e=R).\u0275fac=function(m){return new(m||e)(_.LFG(b.v))},e.\u0275prov=_.Yz7({token:e,factory:e.\u0275fac}),R})()}}]);