"use strict";(self.webpackChunkandon_frontend=self.webpackChunkandon_frontend||[]).push([[835],{4808:(F,S,d)=>{d.d(S,{J:()=>g});var l=d(5861),m=d(6510),p=d(5879),a=d(7278);let g=(()=>{var _;class I{constructor(e){this.http=e}create(e){var u=this;return(0,l.Z)(function*(){return yield u.http.post(m.S.GROUPS.BASE_ENDPOINT,e)})()}findAllFilters(e,u,Z,A,C){var v=this;return(0,l.Z)(function*(){const f=m.S.GROUPS.FILTERS(e,u,Z,A,C);return yield v.http.get(f)})()}delete(e){var u=this;return(0,l.Z)(function*(){yield u.http.delete(m.S.GROUPS.BY_ID(e))})()}findOne(e){var u=this;return(0,l.Z)(function*(){const Z=m.S.GROUPS.BY_ID(e);return yield u.http.get(Z)})()}updateGroup(e,u){var Z=this;return(0,l.Z)(function*(){return yield Z.http.put(m.S.GROUPS.BY_ID(e),u)})()}findAll(){var e=this;return(0,l.Z)(function*(){return yield e.http.get(m.S.GROUPS.BASE_ENDPOINT)})()}}return(_=I).\u0275fac=function(e){return new(e||_)(p.LFG(a.v))},_.\u0275prov=p.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),I})()},1835:(F,S,d)=>{d.r(S),d.d(S,{IncidentsModule:()=>pt});var l=d(6814),m=d(1303),p=d(5861),a=d(6223),g=function(t){return t.UNASSIGNED="Unassigned",t.ASSIGNED="Assigned",t.IN_PROGRESS="In progress",t.CLOSED="Closed",t.CANCEL="Cancel",t}(g||{});const _=Object.values(g);function I(t){switch(t){case g.UNASSIGNED:return"Sin asignar";case g.ASSIGNED:return"Asignado";case g.IN_PROGRESS:return"En progreso";case g.CLOSED:return"Cerrado";case g.CANCEL:return"Cancelado"}return""}var y=d(8693),e=d(5879),u=d(8499),Z=d(9347),A=d(4808),C=d(3680),v=d(8034),f=d(5683),N=d(2032),U=d(8525),h=d(5195),q=d(2296),D=d(617),L=d(1476),T=d(5313),J=d(3031);function G(t,r){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"B\xfasqueda inv\xe1lida"),e.qZA())}function Y(t,r){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Estado inv\xe1lido"),e.qZA())}function M(t,r){if(1&t&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(i.value)}}function R(t,r){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Categor\xeda inv\xe1lida"),e.qZA())}function B(t,r){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha inicial inv\xe1lida"),e.qZA())}function k(t,r){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha final inv\xe1lida"),e.qZA())}function $(t,r){if(1&t&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(i.name)}}function j(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"N\xfamero"),e.qZA())}const P=function(t){return["/","incidents",t]};function z(t,r){if(1&t&&(e.TgZ(0,"td",47)(1,"a",48),e._uU(2),e.qZA()()),2&t){const i=r.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,P,i.id)),e.xp6(1),e.Oqu(i.number)}}function K(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Empleado"),e.qZA())}function V(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.Oqu(i.employee)}}function H(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Descripci\xf3n"),e.qZA())}function W(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.Oqu(i.description)}}function X(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Estado"),e.qZA())}function ee(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const i=r.$implicit,o=e.oxw();e.xp6(1),e.hij(" ",o.incidentStatusToSpanish(i.status)," ")}}function te(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Categor\xeda"),e.qZA())}function ne(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.Oqu(i.category.value)}}function ie(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"L\xednea de producci\xf3n"),e.qZA())}function oe(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.Oqu(i.productionLine.value)}}function re(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Creado en"),e.qZA())}function se(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.ALo(2,"date"),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,i.createdOn,"d/M/yy, h:mm a")," ")}}function ae(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Creado por"),e.qZA())}function de(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,i.createdBy))}}function ce(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Grupo asignado"),e.qZA())}function ue(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.hij(" ",i.assignedGroup?i.assignedGroup.name:""," ")}}function le(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Asignado a"),e.qZA())}function me(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,i.assignedTo)," ")}}function pe(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Cerrado por"),e.qZA())}function _e(t,r){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const i=r.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,i.closedBy))}}function ge(t,r){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Eliminar"),e.qZA())}function fe(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"td",47)(1,"button",49),e.NdJ("click",function(){const s=e.CHM(i).$implicit,c=e.oxw();return e.KtG(c.openDeleteDialog(s.id))}),e.TgZ(2,"mat-icon"),e._uU(3,"close"),e.qZA()()()}}function he(t,r){1&t&&e._UZ(0,"tr",50)}function Ze(t,r){1&t&&e._UZ(0,"tr",51)}function ve(t,r){1&t&&(e.TgZ(0,"p"),e._uU(1," Creado por: "),e.qZA())}function Te(t,r){1&t&&(e.TgZ(0,"p"),e._uU(1,"Grupo asignado:"),e.qZA())}function Ie(t,r){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const i=e.oxw().$implicit;e.xp6(1),e.hij(" Asignado a: ",i.assignedTo," ")}}function Ce(t,r){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const i=e.oxw().$implicit;e.xp6(1),e.hij(" Cerrado por: ",e.lcZ(2,1,i.closedBy)," ")}}function xe(t,r){if(1&t&&(e.TgZ(0,"div",52)(1,"mat-card",53)(2,"mat-card-header",54)(3,"mat-card-subtitle"),e._uU(4),e.qZA(),e.TgZ(5,"mat-card-subtitle"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"mat-card-title"),e._uU(9),e.qZA()(),e.TgZ(10,"mat-card-content")(11,"p",55),e._uU(12),e.qZA(),e.TgZ(13,"p"),e._uU(14),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA(),e.TgZ(17,"p"),e._uU(18),e.qZA(),e.YNc(19,ve,2,0,"p",11),e.YNc(20,Te,2,0,"p",11),e.YNc(21,Ie,2,1,"p",11),e.YNc(22,Ce,3,3,"p",11),e.qZA()()()),2&t){const i=r.$implicit,o=e.oxw();e.Q6J("routerLink",e.VKq(15,P,i.id)),e.xp6(4),e.Oqu(i.number),e.xp6(2),e.hij(" ",e.xi3(7,12,i.createdOn,"d/M/yy, h:mm a"),""),e.xp6(3),e.Oqu(i.description),e.xp6(3),e.hij(" Estado: ",o.incidentStatusToSpanish(i.status)," "),e.xp6(2),e.hij("Empleado: ",i.employee,""),e.xp6(2),e.hij("Categor\xeda: ",i.category.value,""),e.xp6(2),e.hij("L\xednea de Producci\xf3n: ",i.productionLine.value,""),e.xp6(1),e.Q6J("ngIf",i.status==o.status.UNASSIGNED||i.status==o.status.CANCEL),e.xp6(1),e.Q6J("ngIf",i.status==o.status.ASSIGNED),e.xp6(1),e.Q6J("ngIf",i.status==o.status.IN_PROGRESS),e.xp6(1),e.Q6J("ngIf",i.status==o.status.CLOSED)}}const Ae=function(){return["/","incidents","create"]},Se=function(){return["/","incidents"]},w=function(){return[5,10,25,100]};let Ne=(()=>{var t;class r{constructor(o,n,s,c,x){this.incidentsService=o,this.dialog=n,this.groupsService=s,this.route=c,this.router=x,this.status=g,this.incidentStatusToSpanish=I,this.incidents=[],this.categories=[],this.groups=[],this.displayedColumns=["number","employee","description","status","category","productionLine","createdOn","createdBy","assignedGroup","assignedTo","closedBy","delete"],this.filtersForm=new a.cw({search:new a.NI(""),status:new a.NI(""),categoryId:new a.NI(""),startCreatedOn:new a.NI(null),endCreatedOn:new a.NI(null),assignedGroupId:new a.NI("")}),this.page=0,this.pages=0,this.pageSize=25,this.length=0}ngOnInit(){var o=this;this.incidentsService.findAllCategories().then(n=>this.categories=n),this.groupsService.findAll().then(n=>this.groups=n),this.route.queryParams.subscribe(function(){var n=(0,p.Z)(function*(s){o.filtersForm.setValue({search:s.search??"",status:s.status??"",categoryId:s.categoryId??"",startCreatedOn:s.startCreatedOn?new Date(s.startCreatedOn):null,endCreatedOn:s.endCreatedOn?new Date(s.endCreatedOn):null,assignedGroupId:s.assignedGroupId??""}),yield o.getIncidents()});return function(s){return n.apply(this,arguments)}}())}getIncidents(){var o=this;return(0,p.Z)(function*(){if(o.filtersForm.valid){const n=o.filtersForm.value;if(null==n.startCreatedOn&&null==n.endCreatedOn||null!=n.startCreatedOn&&null!=n.endCreatedOn){o.router.navigate([],{queryParams:{search:""==n.search?void 0:n.search,status:""==n.status?void 0:n.status,categoryId:""==n.categoryId?void 0:n.categoryId,startCreatedOn:null==n.startCreatedOn?void 0:new Date(n.startCreatedOn),endCreatedOn:null==n.endCreatedOn?void 0:new Date(n.endCreatedOn),assignedGroupId:""==n.assignedGroupId?void 0:n.assignedGroupId}});const s=yield o.incidentsService.findAll(o.page+1,o.pageSize,""==n.search?void 0:n.search,""==n.status?void 0:n.status,""==n.categoryId?void 0:n.categoryId,null==n.startCreatedOn?void 0:n.startCreatedOn,null==n.endCreatedOn?void 0:n.endCreatedOn,""==n.assignedGroupId?void 0:n.assignedGroupId);o.incidents=s.incidents,o.page=s.page-1,o.pages=s.pages,o.length=s.length}}})()}changePage(o){var n=this;return(0,p.Z)(function*(){n.page=o.pageIndex,n.pageSize=o.pageSize,n.getIncidents()})()}openDeleteDialog(o){var n=this;this.dialog.open(y.F,{data:{cascade:!1}}).afterClosed().subscribe(function(){var c=(0,p.Z)(function*(x){x&&(yield n.incidentsService.remove(o),yield n.getIncidents())});return function(x){return c.apply(this,arguments)}}())}}return(t=r).\u0275fac=function(o){return new(o||t)(e.Y36(u.U),e.Y36(Z.uw),e.Y36(A.J),e.Y36(m.gz),e.Y36(m.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-incidents"]],decls:116,vars:38,consts:[[1,"flex","flex-row","mb-5","px-2","items-center"],[1,"text-3xl","font-bold"],[1,"flex-auto"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"max-xl:hidden"],[1,"bg-white","p-3","rounded-md","shadow-md","mb-4"],[1,"flex","flex-row","flex-wrap",3,"submit"],[1,"mx-2","w-full","max-w-xs"],["appearance","outline",1,"w-full"],["matInput","","type","text",3,"formControl"],["mat-icon-button","","matSuffix","","type","submit"],[4,"ngIf"],[3,"formControl","selectionChange"],["value",""],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[3,"rangePicker"],["matStartDate","","placeholder","Fecha inicial",3,"formControl","dateChange"],["matEndDate","","placeholder","Fecha final",3,"formControl","dateChange"],["matIconSuffix","",3,"for"],["picker",""],[1,"mx-2","flex","items-center"],["mat-raised-button","","color","primary","type","button",3,"routerLink"],[1,"overflow-auto"],["mat-table","",3,"dataSource"],["matColumnDef","number"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","employee"],["matColumnDef","description"],["matColumnDef","status"],["matColumnDef","category"],["matColumnDef","productionLine"],["matColumnDef","createdOn"],["matColumnDef","createdBy"],["matColumnDef","assignedGroup"],["matColumnDef","assignedTo"],["matColumnDef","closedBy"],["matColumnDef","delete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","length","pageSize","pageIndex","page"],[1,"xl:hidden"],[1,"px-2","flex","flex-wrap","justify-around"],["class","!p-2 hover:cursor-pointer basis-1/3","style","min-width: 300px",3,"routerLink",4,"ngFor","ngForOf"],["showFirstLastButtons","",1,"!bg-transparent","mt-2",3,"pageSizeOptions","length","pageSize","pageIndex","page"],["mat-header-cell",""],["mat-cell",""],[1,"text-blue-500","hover:underline",3,"routerLink"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"!p-2","hover:cursor-pointer","basis-1/3",2,"min-width","300px",3,"routerLink"],[1,"hover:bg-red-100","active:bg-red-200",2,"height","240px"],[1,"mb-2"],[1,"text-red-600"]],template:function(o,n){if(1&o&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Incidentes"),e.qZA(),e._UZ(3,"div",2),e.TgZ(4,"button",3),e._uU(5," Crear Incidente "),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5)(8,"form",6),e.NdJ("submit",function(){return n.getIncidents()}),e.TgZ(9,"div",7)(10,"p"),e._uU(11,"Buscar"),e.qZA(),e.TgZ(12,"mat-form-field",8),e._UZ(13,"input",9),e.TgZ(14,"button",10)(15,"mat-icon"),e._uU(16,"search"),e.qZA()(),e.YNc(17,G,2,0,"mat-error",11),e.qZA()(),e.TgZ(18,"div",7)(19,"p"),e._uU(20,"Estado"),e.qZA(),e.TgZ(21,"mat-form-field",8)(22,"mat-select",12),e.NdJ("selectionChange",function(){return n.getIncidents()}),e.TgZ(23,"mat-option",13),e._uU(24,"Todos"),e.qZA(),e.TgZ(25,"mat-option",14),e._uU(26,"Sin asignar"),e.qZA(),e.TgZ(27,"mat-option",14),e._uU(28,"Asignado"),e.qZA(),e.TgZ(29,"mat-option",14),e._uU(30,"En progreso"),e.qZA(),e.TgZ(31,"mat-option",14),e._uU(32,"Cerrado"),e.qZA(),e.TgZ(33,"mat-option",14),e._uU(34,"Cancelado"),e.qZA()(),e.YNc(35,Y,2,0,"mat-error",11),e.qZA()(),e.TgZ(36,"div",7)(37,"p"),e._uU(38,"Categor\xeda"),e.qZA(),e.TgZ(39,"mat-form-field",8)(40,"mat-select",12),e.NdJ("selectionChange",function(){return n.getIncidents()}),e.TgZ(41,"mat-option",13),e._uU(42,"Todas"),e.qZA(),e.YNc(43,M,2,2,"mat-option",15),e.qZA(),e.YNc(44,R,2,0,"mat-error",11),e.qZA()(),e.TgZ(45,"div",7)(46,"p"),e._uU(47,"Creado entre"),e.qZA(),e.TgZ(48,"mat-form-field",8)(49,"mat-date-range-input",16)(50,"input",17),e.NdJ("dateChange",function(){return n.getIncidents()}),e.qZA(),e.TgZ(51,"input",18),e.NdJ("dateChange",function(){return n.getIncidents()}),e.qZA()(),e.TgZ(52,"mat-hint"),e._uU(53,"DD/MM/AAAA - DD/MM/AAAA"),e.qZA(),e._UZ(54,"mat-datepicker-toggle",19)(55,"mat-date-range-picker",null,20),e.YNc(57,B,2,0,"mat-error",11),e.YNc(58,k,2,0,"mat-error",11),e.qZA()(),e.TgZ(59,"div",7)(60,"p"),e._uU(61,"Grupo"),e.qZA(),e.TgZ(62,"mat-form-field",8)(63,"mat-select",12),e.NdJ("selectionChange",function(){return n.getIncidents()}),e.TgZ(64,"mat-option",13),e._uU(65,"Todos"),e.qZA(),e.YNc(66,$,2,2,"mat-option",15),e.qZA()()(),e.TgZ(67,"div",21)(68,"button",22),e._uU(69," Limpiar "),e.qZA()()()(),e.TgZ(70,"div",5)(71,"div",23)(72,"table",24),e.ynx(73,25),e.YNc(74,j,2,0,"th",26),e.YNc(75,z,3,4,"td",27),e.BQk(),e.ynx(76,28),e.YNc(77,K,2,0,"th",26),e.YNc(78,V,2,1,"td",27),e.BQk(),e.ynx(79,29),e.YNc(80,H,2,0,"th",26),e.YNc(81,W,2,1,"td",27),e.BQk(),e.ynx(82,30),e.YNc(83,X,2,0,"th",26),e.YNc(84,ee,2,1,"td",27),e.BQk(),e.ynx(85,31),e.YNc(86,te,2,0,"th",26),e.YNc(87,ne,2,1,"td",27),e.BQk(),e.ynx(88,32),e.YNc(89,ie,2,0,"th",26),e.YNc(90,oe,2,1,"td",27),e.BQk(),e.ynx(91,33),e.YNc(92,re,2,0,"th",26),e.YNc(93,se,3,4,"td",27),e.BQk(),e.ynx(94,34),e.YNc(95,ae,2,0,"th",26),e.YNc(96,de,3,3,"td",27),e.BQk(),e.ynx(97,35),e.YNc(98,ce,2,0,"th",26),e.YNc(99,ue,2,1,"td",27),e.BQk(),e.ynx(100,36),e.YNc(101,le,2,0,"th",26),e.YNc(102,me,3,3,"td",27),e.BQk(),e.ynx(103,37),e.YNc(104,pe,2,0,"th",26),e.YNc(105,_e,3,3,"td",27),e.BQk(),e.ynx(106,38),e.YNc(107,ge,2,0,"th",26),e.YNc(108,fe,4,0,"td",27),e.BQk(),e.YNc(109,he,1,0,"tr",39),e.YNc(110,Ze,1,0,"tr",40),e.qZA()(),e.TgZ(111,"mat-paginator",41),e.NdJ("page",function(c){return n.changePage(c)}),e.qZA()()(),e.TgZ(112,"div",42)(113,"div",43),e.YNc(114,xe,23,17,"div",44),e.qZA(),e.TgZ(115,"mat-paginator",45),e.NdJ("page",function(c){return n.changePage(c)}),e.qZA()()),2&o){const s=e.MAs(56);e.xp6(4),e.Q6J("routerLink",e.DdM(34,Ae)),e.xp6(9),e.Q6J("formControl",n.filtersForm.controls.search),e.xp6(4),e.Q6J("ngIf",n.filtersForm.controls.search.invalid),e.xp6(5),e.Q6J("formControl",n.filtersForm.controls.status),e.xp6(3),e.Q6J("value",n.status.UNASSIGNED),e.xp6(2),e.Q6J("value",n.status.ASSIGNED),e.xp6(2),e.Q6J("value",n.status.IN_PROGRESS),e.xp6(2),e.Q6J("value",n.status.CLOSED),e.xp6(2),e.Q6J("value",n.status.CANCEL),e.xp6(2),e.Q6J("ngIf",n.filtersForm.controls.status.invalid),e.xp6(5),e.Q6J("formControl",n.filtersForm.controls.categoryId),e.xp6(3),e.Q6J("ngForOf",n.categories),e.xp6(1),e.Q6J("ngIf",n.filtersForm.controls.categoryId.invalid),e.xp6(5),e.Q6J("rangePicker",s),e.xp6(1),e.Q6J("formControl",n.filtersForm.controls.startCreatedOn),e.xp6(1),e.Q6J("formControl",n.filtersForm.controls.endCreatedOn),e.xp6(3),e.Q6J("for",s),e.xp6(3),e.Q6J("ngIf",n.filtersForm.controls.startCreatedOn.invalid),e.xp6(1),e.Q6J("ngIf",n.filtersForm.controls.endCreatedOn.invalid),e.xp6(5),e.Q6J("formControl",n.filtersForm.controls.assignedGroupId),e.xp6(3),e.Q6J("ngForOf",n.groups),e.xp6(2),e.Q6J("routerLink",e.DdM(35,Se)),e.xp6(4),e.Q6J("dataSource",n.incidents),e.xp6(37),e.Q6J("matHeaderRowDef",n.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(36,w))("length",n.length)("pageSize",n.pageSize)("pageIndex",n.page),e.xp6(3),e.Q6J("ngForOf",n.incidents),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(37,w))("length",n.length)("pageSize",n.pageSize)("pageIndex",n.page)}},dependencies:[l.sg,l.O5,m.rH,C.ey,v.nW,v.wx,v.zY,v.By,v._g,f.KE,f.bx,f.TO,f.R9,N.Nt,U.gD,h.a8,h.dn,h.dk,h.$j,h.n5,q.lW,q.RK,D.Hw,L.NW,T.BZ,T.fO,T.as,T.w1,T.Dz,T.nj,T.ge,T.ev,T.XQ,T.Gk,a._Y,a.Fj,a.JJ,a.JL,a.F,a.oH,l.uU,J.k]}),r})();var b=d(9627);function ye(t,r){if(1&t&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(i.value)}}function Ue(t,r){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Categor\xeda inv\xe1lida"),e.qZA())}function qe(t,r){if(1&t&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(i.value)}}function Oe(t,r){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"L\xednea de producci\xf3n inv\xe1lida"),e.qZA())}function Ee(t,r){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Empleado inv\xe1lido"),e.qZA())}function Fe(t,r){1&t&&(e.TgZ(0,"mat-error",19),e._uU(1,"Descripci\xf3n inv\xe1lida"),e.qZA())}let De=(()=>{var t;class r{constructor(o,n,s){this.incidentsService=o,this.productionLinesService=n,this.router=s,this.categories=[],this.productionLines=[],this.createIncidentForm=new a.cw({category:new a.NI("",[a.kI.required,a.kI.maxLength(64)]),productionLine:new a.NI("",[a.kI.required,a.kI.maxLength(64)]),employee:new a.NI("",[a.kI.required,a.kI.maxLength(128)]),description:new a.NI("",[a.kI.required])})}ngOnInit(){var o=this;return(0,p.Z)(function*(){o.categories=yield o.incidentsService.findAllCategories(),o.productionLines=yield o.productionLinesService.findAll()})()}create(){var o=this;return(0,p.Z)(function*(){if(o.createIncidentForm.valid){const n=o.createIncidentForm.value,s=yield o.incidentsService.create({category:n.category,productionLine:n.productionLine,employee:n.employee,description:n.description});s&&o.router.navigate(["incidents",s.id])}})()}}return(t=r).\u0275fac=function(o){return new(o||t)(e.Y36(u.U),e.Y36(b.F),e.Y36(m.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-create-incident"]],decls:37,vars:8,consts:[[1,"flex","flex-row","mb-5","px-2","items-center"],[1,"text-3xl","font-bold"],[3,"formGroup","submit"],[1,"bg-white","py-3","px-2","rounded-md","shadow-md","mb-4"],[1,"flex","flex-row","flex-wrap"],[1,"flex-1","mx-2"],["appearance","outline",1,"w-full"],["formControlName","category"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","productionLine"],[1,"flex-1","mx-2","flex-aux"],["matInput","","formControlName","employee"],[1,"mx-2"],["matInput","","formControlName","description"],["class","resize-none",4,"ngIf"],[1,"flex","flex-row-reverse","me-4"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"value"],[1,"resize-none"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Crear Incidente"),e.qZA()(),e.TgZ(3,"form",2),e.NdJ("submit",function(){return n.create()}),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"p"),e._uU(8,"Categor\xeda"),e.qZA(),e.TgZ(9,"mat-form-field",6)(10,"mat-select",7),e.YNc(11,ye,2,2,"mat-option",8),e.qZA(),e.YNc(12,Ue,2,0,"mat-error",9),e.qZA()(),e.TgZ(13,"div",5)(14,"p"),e._uU(15,"L\xednea de Producci\xf3n"),e.qZA(),e.TgZ(16,"mat-form-field",6)(17,"mat-select",10),e.YNc(18,qe,2,2,"mat-option",8),e.qZA(),e.YNc(19,Oe,2,0,"mat-error",9),e.qZA()()(),e.TgZ(20,"div",4)(21,"div",11)(22,"p"),e._uU(23,"Empleado"),e.qZA(),e.TgZ(24,"mat-form-field",6),e._UZ(25,"input",12),e.YNc(26,Ee,2,0,"mat-error",9),e.qZA()(),e._UZ(27,"div",11),e.qZA(),e.TgZ(28,"div",13)(29,"p"),e._uU(30,"Descripci\xf3n"),e.qZA(),e.TgZ(31,"mat-form-field",6),e._UZ(32,"textarea",14),e.YNc(33,Fe,2,0,"mat-error",15),e.qZA()()(),e.TgZ(34,"div",16)(35,"button",17),e._uU(36," Crear "),e.qZA()()()),2&o&&(e.xp6(3),e.Q6J("formGroup",n.createIncidentForm),e.xp6(8),e.Q6J("ngForOf",n.categories),e.xp6(1),e.Q6J("ngIf",n.createIncidentForm.controls.category.invalid),e.xp6(6),e.Q6J("ngForOf",n.productionLines),e.xp6(1),e.Q6J("ngIf",n.createIncidentForm.controls.productionLine.invalid),e.xp6(7),e.Q6J("ngIf",n.createIncidentForm.controls.employee.invalid),e.xp6(7),e.Q6J("ngIf",n.createIncidentForm.controls.description.invalid),e.xp6(2),e.Q6J("disabled",n.createIncidentForm.invalid))},dependencies:[l.sg,l.O5,C.ey,f.KE,f.TO,N.Nt,U.gD,q.lW,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u],styles:["textarea[_ngcontent-%COMP%]{height:100px!important}.flex-aux[_ngcontent-%COMP%]{width:100%;min-width:212px}"]}),r})();var Q=function(t){return t.P0="P0",t.P1="P1",t.P2="P2",t.P3="P3",t}(Q||{});const Je=Object.values(Q);var Pe=d(8080),we=d(2939),be=d(8645),Qe=d(9773),Le=d(7398),O=d(4221);const Ge=(0,O.ZF)("permissions"),Ye=(0,O.P1)(Ge,t=>t.permissions);let Me=(()=>{var t;class r{set appFieldPermissions(o){this.permissions$.pipe((0,Qe.R)(this.destroy$),(0,Le.U)(n=>{const s=n?.permissions?.fields[o];s?this.setFieldVisibilityAndEditability(s.canRead,s.canWrite):this.hideAndMakeReadonly()}))}constructor(o,n,s){this.el=o,this.renderer=n,this.store=s,this.permissions$=this.store.select(Ye),this.destroy$=new be.x}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}hideAndMakeReadonly(){this.applyStylesRecursively(this.el.nativeElement,"readonly")}setFieldVisibilityAndEditability(o,n){Array.from(this.el.nativeElement.children).forEach(c=>{o?this.renderer.removeClass(c,"hidden"):this.renderer.addClass(c,"hidden"),n?this.renderer.removeClass(c,"readonly"):(this.renderer.addClass(c,"readonly"),this.renderer.setStyle(c,"background-color","#f5f5f5"))})}applyStylesRecursively(o,...n){n.forEach(c=>this.renderer.addClass(o,c));const s=o.children;s&&Array.from(s).forEach(c=>this.applyStylesRecursively(c,...n))}}return(t=r).\u0275fac=function(o){return new(o||t)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(O.yh))},t.\u0275dir=e.lG2({type:t,selectors:[["","appFieldPermissions",""]],inputs:{appFieldPermissions:"appFieldPermissions"}}),r})();function Re(t,r){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const i=r.$implicit,o=e.oxw(2);e.Q6J("value",i),e.xp6(1),e.Oqu(o.incidentStatusToSpanish(i))}}function Be(t,r){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(i.value)}}function ke(t,r){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(i.value)}}function $e(t,r){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(i.name)}}function je(t,r){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(e.lcZ(2,2,i))}}function ze(t,r){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i.id),e.xp6(1),e.Oqu(i.value)}}function Ke(t,r){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const i=r.$implicit;e.Q6J("value",i),e.xp6(1),e.Oqu(i)}}function Ve(t,r){if(1&t&&(e.TgZ(0,"div",23)(1,"div",24)(2,"mat-icon",25),e._uU(3,"schedule"),e.qZA(),e.TgZ(4,"div"),e._uU(5,"Tiempo de paro"),e.qZA()(),e.TgZ(6,"div",26)(7,"p"),e._uU(8),e.qZA()()()),2&t){const i=e.oxw(2);e.xp6(8),e.lnq(" ",0==i.closeTime.days?"":1==i.closeTime.days?i.closeTime.days+" d\xeda, ":i.closeTime.days+" d\xedas, "," ",0==i.closeTime.hours?"":1==i.closeTime.hours?i.closeTime.hours+" hora, ":i.closeTime.hours+" horas, "," ",1==i.closeTime.minutes?i.closeTime.minutes+" minuto":i.closeTime.minutes+" minutos"," ")}}function He(t,r){if(1&t&&(e.TgZ(0,"div",23)(1,"div",24)(2,"mat-icon",25),e._uU(3,"account_circle"),e.qZA(),e.TgZ(4,"div"),e._uU(5,"Cerrado por"),e.qZA()(),e.TgZ(6,"div",26)(7,"p"),e._uU(8),e.ALo(9,"fullName"),e.qZA()()()),2&t){const i=e.oxw(2);e.xp6(8),e.Oqu(e.lcZ(9,1,i.incident.closedBy))}}function We(t,r){if(1&t&&(e.TgZ(0,"div",23)(1,"div",24)(2,"mat-icon",25),e._uU(3,"event"),e.qZA(),e.TgZ(4,"div"),e._uU(5,"Cerrado en"),e.qZA()(),e.TgZ(6,"div",26)(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA()()()),2&t){const i=e.oxw(2);e.xp6(8),e.Oqu(e.xi3(9,1,i.incident.closedOn,"d/M/yy, h:mm a"))}}function Xe(t,r){1&t&&(e.TgZ(0,"div",40)(1,"p"),e._uU(2,"Tiempo de resoluci\xf3n"),e.qZA(),e.TgZ(3,"mat-form-field",7)(4,"mat-select",41)(5,"mat-option",39),e._uU(6,"15 minutos"),e.qZA(),e.TgZ(7,"mat-option",39),e._uU(8,"30 minutos"),e.qZA(),e.TgZ(9,"mat-option",39),e._uU(10,"45 minutos"),e.qZA(),e.TgZ(11,"mat-option",39),e._uU(12,"1 hora"),e.qZA(),e.TgZ(13,"mat-option",39),e._uU(14,"1 hora 15 minutos"),e.qZA(),e.TgZ(15,"mat-option",39),e._uU(16,"1 hora 30 minutos"),e.qZA(),e.TgZ(17,"mat-option",39),e._uU(18,"1 hora 45 minutos"),e.qZA(),e.TgZ(19,"mat-option",39),e._uU(20,"2 horas"),e.qZA()(),e.TgZ(21,"mat-error"),e._uU(22,"Tiempo de resoluci\xf3n inv\xe1lido"),e.qZA()(),e.TgZ(23,"p"),e._uU(24,"Soluci\xf3n propuesta"),e.qZA(),e.TgZ(25,"mat-form-field",7),e._UZ(26,"textarea",42),e.TgZ(27,"mat-error"),e._uU(28,"Soluci\xf3n propuesta inv\xe1lida"),e.qZA()()()),2&t&&(e.Q6J("appFieldPermissions","resolutionTimeInMinutes"),e.xp6(5),e.Q6J("value",15),e.xp6(2),e.Q6J("value",30),e.xp6(2),e.Q6J("value",45),e.xp6(2),e.Q6J("value",60),e.xp6(2),e.Q6J("value",75),e.xp6(2),e.Q6J("value",90),e.xp6(2),e.Q6J("value",105),e.xp6(2),e.Q6J("value",120))}function et(t,r){if(1&t&&(e.TgZ(0,"div",40)(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"mat-form-field",7),e._UZ(4,"textarea",43),e.TgZ(5,"mat-error"),e._uU(6),e.qZA()()()),2&t){const i=e.oxw(2);e.Q6J("appFieldPermissions","closeNotes"),e.xp6(2),e.hij(" Notas de ",i.incidentForm.controls.status.value==i.incidentSingleStatus.CLOSED?"cierre":"cancelaci\xf3n"," "),e.xp6(4),e.hij("Notas de ",i.incidentForm.controls.status.value==i.incidentSingleStatus.CLOSED?"cierre":"cancelaci\xf3n"," inv\xe1lidas")}}function tt(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return n.incidentForm.controls.status.setValue(n.incidentSingleStatus.ASSIGNED),e.KtG(n.statusChanged())}),e._uU(1," Asignar "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnAssign")}function nt(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return n.incidentForm.controls.status.setValue(n.incidentSingleStatus.IN_PROGRESS),e.KtG(n.statusChanged())}),e._uU(1," En progreso "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnInProgress")}function it(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return n.incidentForm.controls.status.setValue(n.incidentSingleStatus.CLOSED),e.KtG(n.statusChanged())}),e._uU(1," Cerrar "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnClose")}function ot(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return n.incidentForm.controls.status.setValue(n.incidentSingleStatus.IN_PROGRESS),e.KtG(n.statusChanged())}),e._uU(1," Abrir "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnOpen")}function rt(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return n.incidentForm.controls.status.setValue(n.incidentSingleStatus.CANCEL),e.KtG(n.statusChanged())}),e._uU(1," Cancelar "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnCancel")}function st(t,r){if(1&t&&(e.TgZ(0,"div",46)(1,"div")(2,"div",47)(3,"mat-icon",48),e._uU(4,"person"),e.qZA(),e.TgZ(5,"div"),e._uU(6),e.ALo(7,"fullName"),e.qZA(),e._UZ(8,"div",3),e.TgZ(9,"div"),e._uU(10),e.ALo(11,"date"),e.qZA()()(),e.TgZ(12,"div",49),e._uU(13),e.qZA()()),2&t){const i=r.$implicit;e.xp6(6),e.hij(" ",e.lcZ(7,3,i.createdBy)," "),e.xp6(4),e.Oqu(e.xi3(11,5,i.createdOn,"d/M/yy, h:mm a")),e.xp6(3),e.hij(" ",i.value," ")}}function at(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"div")(1,"div",1)(2,"h1",2),e._uU(3),e.qZA(),e._UZ(4,"div",3),e.qZA(),e.TgZ(5,"form",4),e.NdJ("submit",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.update())}),e.TgZ(6,"div",5)(7,"div",6)(8,"p"),e._uU(9,"Descripci\xf3n"),e.qZA(),e.TgZ(10,"mat-form-field",7),e._UZ(11,"textarea",8),e.TgZ(12,"mat-error"),e._uU(13,"Descripci\xf3n inv\xe1lida"),e.qZA()()(),e.TgZ(14,"div",9)(15,"div",10)(16,"p"),e._uU(17,"Estado"),e.qZA(),e.TgZ(18,"mat-form-field",7)(19,"mat-select",11),e.NdJ("selectionChange",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.statusChanged())}),e.YNc(20,Re,2,2,"mat-option",12),e.qZA(),e.TgZ(21,"mat-error"),e._uU(22,"Estado inv\xe1lido"),e.qZA()()(),e.TgZ(23,"div",10)(24,"p"),e._uU(25,"Categor\xeda"),e.qZA(),e.TgZ(26,"mat-form-field",7)(27,"mat-select",13),e.YNc(28,Be,2,2,"mat-option",12),e.qZA(),e.TgZ(29,"mat-error"),e._uU(30,"Categor\xeda inv\xe1lida"),e.qZA()()()(),e.TgZ(31,"div",9)(32,"div",10)(33,"p"),e._uU(34,"Linea de producci\xf3n"),e.qZA(),e.TgZ(35,"mat-form-field",7)(36,"mat-select",14),e.YNc(37,ke,2,2,"mat-option",12),e.qZA(),e.TgZ(38,"mat-error"),e._uU(39,"Linea de producci\xf3n inv\xe1lida"),e.qZA()()(),e.TgZ(40,"div",10)(41,"p"),e._uU(42,"Grupo de apoyo"),e.qZA(),e.TgZ(43,"mat-form-field",7)(44,"mat-select",15),e.NdJ("selectionChange",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.assignedGroupChanged())}),e.TgZ(45,"mat-option",16),e._uU(46,"-- Sin grupo de apoyo --"),e.qZA(),e.YNc(47,$e,2,2,"mat-option",12),e.qZA(),e.TgZ(48,"mat-error"),e._uU(49,"Grupo de apoyo inv\xe1lido"),e.qZA()()()(),e.TgZ(50,"div",9)(51,"div",10)(52,"p"),e._uU(53,"Asignado a"),e.qZA(),e.TgZ(54,"mat-form-field",7)(55,"mat-select",17)(56,"mat-option",16),e._uU(57,"-- Sin persona asignada --"),e.qZA(),e.YNc(58,je,3,4,"mat-option",12),e.qZA(),e.TgZ(59,"mat-error"),e._uU(60,"Asignado inv\xe1lido"),e.qZA()()(),e.TgZ(61,"div",10)(62,"p"),e._uU(63,"M\xe1quina"),e.qZA(),e.TgZ(64,"mat-form-field",7)(65,"mat-select",18)(66,"mat-option",16),e._uU(67,"-- Sin m\xe1quina --"),e.qZA(),e.YNc(68,ze,2,2,"mat-option",12),e.qZA(),e.TgZ(69,"mat-error"),e._uU(70,"M\xe1quina inv\xe1lida"),e.qZA()()()(),e.TgZ(71,"div",9)(72,"div",10)(73,"p"),e._uU(74,"Prioridad"),e.qZA(),e.TgZ(75,"mat-form-field",7)(76,"mat-select",19)(77,"mat-option",16),e._uU(78,"-- Sin prioridad --"),e.qZA(),e.YNc(79,Ke,2,2,"mat-option",12),e.qZA(),e.TgZ(80,"mat-error"),e._uU(81,"Prioridad inv\xe1lida"),e.qZA()()(),e.TgZ(82,"div",20),e._UZ(83,"div",21),e.qZA()()(),e.TgZ(84,"div",22)(85,"div",23)(86,"div",24)(87,"mat-icon",25),e._uU(88,"schedule"),e.qZA(),e.TgZ(89,"div"),e._uU(90,"Tiempo de asignaci\xf3n"),e.qZA()(),e.TgZ(91,"div",26)(92,"p"),e._uU(93),e.qZA()()(),e.YNc(94,Ve,9,3,"div",27),e.TgZ(95,"div",23)(96,"div",24)(97,"mat-icon",25),e._uU(98,"person"),e.qZA(),e.TgZ(99,"div"),e._uU(100,"Empleado"),e.qZA()(),e.TgZ(101,"div",26)(102,"p"),e._uU(103),e.qZA()()(),e.TgZ(104,"div",23)(105,"div",24)(106,"mat-icon",25),e._uU(107,"account_circle"),e.qZA(),e.TgZ(108,"div"),e._uU(109,"Creado por"),e.qZA()(),e.TgZ(110,"div",26)(111,"p"),e._uU(112),e.ALo(113,"fullName"),e.qZA()()(),e.TgZ(114,"div",23)(115,"div",24)(116,"mat-icon",25),e._uU(117,"event"),e.qZA(),e.TgZ(118,"div"),e._uU(119,"Creado en"),e.qZA()(),e.TgZ(120,"div",26)(121,"p"),e._uU(122),e.ALo(123,"date"),e.qZA()()(),e.YNc(124,He,10,3,"div",27),e.YNc(125,We,10,4,"div",27),e.qZA(),e.YNc(126,Xe,29,9,"div",28),e.YNc(127,et,7,3,"div",28),e.TgZ(128,"div",29),e.YNc(129,tt,2,1,"button",30),e.YNc(130,nt,2,1,"button",30),e.YNc(131,it,2,1,"button",30),e.YNc(132,ot,2,1,"button",30),e.YNc(133,rt,2,1,"button",31),e.TgZ(134,"button",32),e._uU(135," Guardar "),e.qZA()()(),e.TgZ(136,"form",33),e.NdJ("submit",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.comment())}),e.TgZ(137,"h2",34),e._uU(138,"Comentarios"),e.qZA(),e.YNc(139,st,14,8,"div",35),e.TgZ(140,"div",26)(141,"mat-form-field",36),e._UZ(142,"input",37),e.TgZ(143,"mat-error"),e._uU(144,"Comentario inv\xe1lido"),e.qZA()(),e.TgZ(145,"button",38)(146,"mat-icon"),e._uU(147,"send"),e.qZA()()()()()}if(2&t){const i=e.oxw();e.xp6(3),e.hij("Incidente: ",i.incident.number,""),e.xp6(2),e.Q6J("formGroup",i.incidentForm),e.xp6(2),e.Q6J("appFieldPermissions","description"),e.xp6(8),e.Q6J("appFieldPermissions","status"),e.xp6(5),e.Q6J("ngForOf",i.incidentStatus),e.xp6(3),e.Q6J("appFieldPermissions","category"),e.xp6(5),e.Q6J("ngForOf",i.incidentCategories),e.xp6(4),e.Q6J("appFieldPermissions","productionLine"),e.xp6(5),e.Q6J("ngForOf",i.productionLines),e.xp6(3),e.Q6J("appFieldPermissions","assignedGroup"),e.xp6(7),e.Q6J("ngForOf",i.groups),e.xp6(4),e.Q6J("appFieldPermissions","assignedTo"),e.xp6(7),e.Q6J("ngForOf",i.users),e.xp6(3),e.Q6J("appFieldPermissions","machine"),e.xp6(7),e.Q6J("ngForOf",i.machines),e.xp6(4),e.Q6J("appFieldPermissions","priority"),e.xp6(7),e.Q6J("ngForOf",i.IncidentPriorities),e.xp6(14),e.lnq(" ",0==i.inProgressTime.days?"":1==i.inProgressTime.days?i.inProgressTime.days+" d\xeda, ":i.inProgressTime.days+" d\xedas, "," ",0==i.inProgressTime.hours?"":1==i.inProgressTime.hours?i.inProgressTime.hours+" hora, ":i.inProgressTime.hours+" horas, "," ",1==i.inProgressTime.minutes?i.inProgressTime.minutes+" minuto":i.inProgressTime.minutes+" minutos"," "),e.xp6(1),e.Q6J("ngIf",i.incident.status==i.incidentSingleStatus.IN_PROGRESS||i.incident.status==i.incidentSingleStatus.CLOSED),e.xp6(9),e.Oqu(i.incident.employee),e.xp6(9),e.Oqu(e.lcZ(113,35,i.incident.createdBy)),e.xp6(10),e.Oqu(e.xi3(123,37,i.incident.createdOn,"d/M/yy, h:mm a")),e.xp6(2),e.Q6J("ngIf",i.incident.status==i.incidentSingleStatus.CLOSED),e.xp6(1),e.Q6J("ngIf",i.incident.status==i.incidentSingleStatus.CLOSED),e.xp6(1),e.Q6J("ngIf",i.incidentForm.controls.status.value==i.incidentSingleStatus.IN_PROGRESS||i.incidentForm.controls.status.value==i.incidentSingleStatus.CLOSED),e.xp6(1),e.Q6J("ngIf",i.incidentForm.controls.status.value==i.incidentSingleStatus.CLOSED||i.incidentForm.controls.status.value==i.incidentSingleStatus.CANCEL),e.xp6(2),e.Q6J("ngIf",i.incidentForm.controls.status.value==i.incidentSingleStatus.UNASSIGNED),e.xp6(1),e.Q6J("ngIf",i.incidentForm.controls.status.value==i.incidentSingleStatus.ASSIGNED),e.xp6(1),e.Q6J("ngIf",i.incidentForm.controls.status.value==i.incidentSingleStatus.IN_PROGRESS),e.xp6(1),e.Q6J("ngIf",i.incidentForm.controls.status.value==i.incidentSingleStatus.CLOSED||i.incidentForm.controls.status.value==i.incidentSingleStatus.CANCEL),e.xp6(1),e.Q6J("ngIf",i.incidentForm.controls.status.value!=i.incidentSingleStatus.CANCEL),e.xp6(3),e.Q6J("formGroup",i.commentForm),e.xp6(3),e.Q6J("ngForOf",i.incident.comments)}}const dt=[{path:"",component:Ne},{path:"create",component:De},{path:":id",component:(()=>{var t;class r{constructor(o,n,s,c,x,E,_t){this.incidentsService=o,this.productionLinesService=n,this.groupsService=s,this.machinesService=c,this.snackBar=x,this.route=E,this.router=_t,this.incidentStatus=_,this.incidentCategories=[],this.productionLines=[],this.machines=[],this.groups=[],this.users=[],this.IncidentPriorities=Je,this.inProgressTime={days:0,hours:0,minutes:0},this.closeTime={days:0,hours:0,minutes:0},this.incidentStatusToSpanish=I,this.incidentSingleStatus=g,this.incidentForm=new a.cw({description:new a.NI("",[a.kI.required]),status:new a.NI(g.UNASSIGNED,[a.kI.required]),categoryId:new a.NI("",[a.kI.required]),productionLineId:new a.NI("",[a.kI.required]),assignedGroupId:new a.NI(""),assignedToId:new a.NI({value:"",disabled:!0}),machineId:new a.NI(""),priority:new a.NI(""),resolutionTimeInMinutes:new a.NI(""),proposedSolution:new a.NI(""),closeNotes:new a.NI("")}),this.commentForm=new a.cw({value:new a.NI("",[a.kI.required])})}ngOnInit(){var o=this;return(0,p.Z)(function*(){yield o.getIncident(),o.incidentsService.findAllCategories().then(n=>o.incidentCategories=n),o.productionLinesService.findAll().then(n=>o.productionLines=n),o.machinesService.findAll().then(n=>o.machines=n),o.groupsService.findAll().then(n=>o.groups=n)})()}calculateTimeDifference(o,n){const s=n?n-o:o;return{days:Math.floor(s/864e5),hours:Math.floor(s%864e5/36e5),minutes:Math.floor(s%36e5/6e4)}}setTimes(){clearInterval(this.inProgressInterval),clearInterval(this.closedInterval),this.incident.inProgressOn?this.inProgressTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),new Date(this.incident.inProgressOn).getTime()):(this.inProgressTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),(new Date).getTime()),this.inProgressInterval=setInterval(()=>{this.inProgressTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),(new Date).getTime())},1e4)),this.incident.status!=this.incidentSingleStatus.CLOSED&&this.incident.status!=this.incidentSingleStatus.CANCEL||!this.incident.closedOn?(this.closeTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),(new Date).getTime()),this.closedInterval=setInterval(()=>{this.closeTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),(new Date).getTime())},1e4)):this.closeTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),new Date(this.incident.closedOn).getTime())}getIncident(){var o=this;return(0,p.Z)(function*(){try{o.incident=yield o.incidentsService.findOne(o.route.snapshot.params.id),o.incidentForm.setValue({status:o.incident.status,description:o.incident.description,categoryId:o.incident.category.id,productionLineId:o.incident.productionLine.id,assignedGroupId:o.incident.assignedGroup?o.incident.assignedGroup.id:"",assignedToId:o.incident.assignedTo?o.incident.assignedTo.id:"",machineId:o.incident.machine?o.incident.machine.id:"",priority:o.incident.priority??"",resolutionTimeInMinutes:o.incident.resolutionTimeInMinutes??NaN,proposedSolution:o.incident.proposedSolution??"",closeNotes:o.incident.closeNotes?o.incident.closeNotes:""}),o.setTimes(),o.statusChanged(),o.assignedGroupChanged(!1)}catch{o.router.navigate(["/","errors","404"])}})()}statusChanged(){var o=this;return(0,p.Z)(function*(){const n=o.incidentForm.controls.status.value,s=o.incidentForm.controls;n==o.incidentSingleStatus.ASSIGNED||n==o.incidentSingleStatus.IN_PROGRESS||n==o.incidentSingleStatus.CLOSED?s.assignedGroupId.setValidators(a.kI.required):s.assignedGroupId.clearValidators(),n==o.incidentSingleStatus.IN_PROGRESS||n==o.incidentSingleStatus.CLOSED?(s.resolutionTimeInMinutes.addValidators([a.kI.required,a.kI.pattern(/^\d*$/)]),s.proposedSolution.addValidators(a.kI.required),s.assignedToId.addValidators(a.kI.required)):(s.resolutionTimeInMinutes.clearValidators(),s.proposedSolution.clearValidators(),s.assignedToId.clearValidators()),n==o.incidentSingleStatus.CLOSED||n==o.incidentSingleStatus.CANCEL?s.closeNotes.setValidators(a.kI.required):s.closeNotes.clearValidators();for(const c of Object.keys(s))s[c].updateValueAndValidity()})()}assignedGroupChanged(o=!0){var n=this;return(0,p.Z)(function*(){const s=n.incidentForm.controls.assignedGroupId,c=n.incidentForm.controls;""!=s.value?(n.users=(yield n.groupsService.findOne(s.value)).users,o&&c.assignedToId.setValue(""),c.assignedToId.enable()):(c.assignedToId.setValue(""),c.assignedToId.disable())})()}update(){var o=this;return(0,p.Z)(function*(){if(o.incidentForm.valid){const n=o.incidentForm.value;let s={description:n.description,status:n.status,categoryId:n.categoryId,productionLineId:n.productionLineId,assignedGroupId:""==n.assignedGroupId?void 0:n.assignedGroupId,assignedToId:""==n.assignedToId?void 0:n.assignedToId,machineId:""==n.machineId?void 0:n.machineId,priority:""==n.priority?void 0:n.priority};(n.status==o.incidentSingleStatus.IN_PROGRESS||n.status==o.incidentSingleStatus.CLOSED)&&(s={resolutionTimeInMinutes:""==n.resolutionTimeInMinutes?void 0:n.resolutionTimeInMinutes,proposedSolution:""==n.proposedSolution?void 0:n.proposedSolution,...s}),(n.status==o.incidentSingleStatus.CLOSED||n.status==o.incidentSingleStatus.CANCEL)&&(s={closeNotes:""==n.closeNotes?void 0:n.closeNotes,...s}),yield o.incidentsService.update(o.incident.id,s),yield o.getIncident(),o.snackBar.open("Incidente actualizado",void 0,{duration:2e3,horizontalPosition:"end",verticalPosition:"bottom"})}})()}comment(){var o=this;return(0,p.Z)(function*(){if(o.commentForm.valid){const n=o.commentForm.value;yield o.incidentsService.createComment({value:n.value,incidentId:o.incident.id}),o.commentForm.reset(),yield o.getIncident()}})()}}return(t=r).\u0275fac=function(o){return new(o||t)(e.Y36(u.U),e.Y36(b.F),e.Y36(A.J),e.Y36(Pe.M),e.Y36(we.ux),e.Y36(m.gz),e.Y36(m.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-incident"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"flex","flex-row","mb-5","px-2","items-center"],[1,"text-3xl","font-bold"],[1,"flex-auto"],[1,"mb-4",3,"formGroup","submit"],[1,"bg-white","p-3","rounded-md","shadow-md","mb-4"],[1,"px-2",3,"appFieldPermissions"],["appearance","outline",1,"w-full"],["matInput","","formControlName","description"],[1,"flex","flex-row","flex-wrap"],[1,"px-2","flex-auto",3,"appFieldPermissions"],["formControlName","status",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","categoryId"],["formControlName","productionLineId"],["formControlName","assignedGroupId",3,"selectionChange"],["value",""],["formControlName","assignedToId"],["formControlName","machineId"],["formControlName","priority"],[1,"px-2","flex-auto"],[2,"width","212px"],[1,"bg-white","py-3","rounded-md","shadow-md","mb-4","px-5"],[1,"flex","flex-row","my-2"],[1,"flex","flex-row","items-center","w-52"],[1,"me-3"],[1,"flex","flex-row","items-center"],["class","flex flex-row my-2",4,"ngIf"],["class","bg-white py-3 px-5 rounded-md shadow-md mb-4",3,"appFieldPermissions",4,"ngIf"],[1,"flex","flex-row","justify-end"],["type","button","mat-raised-button","","color","primary",3,"appFieldPermissions","click",4,"ngIf"],["class","ms-2","type","button","mat-raised-button","","color","primary",3,"appFieldPermissions","click",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"ms-2"],[1,"bg-white","p-3","rounded-md","shadow-md","mb-4",3,"formGroup","submit"],[1,"font-bold","text-xl","mb-4"],["class","shadow-none bg-slate-200 rounded-md mb-4",4,"ngFor","ngForOf"],["appearance","outline",1,"w-full","me-2"],["matInput","","placeholder","Agregar nuevo comentario","formControlName","value"],["mat-icon-button","","color","primary","type","submit",1,"mb-6"],[3,"value"],[1,"bg-white","py-3","px-5","rounded-md","shadow-md","mb-4",3,"appFieldPermissions"],["formControlName","resolutionTimeInMinutes"],["matInput","","formControlName","proposedSolution"],["matInput","","formControlName","closeNotes"],["type","button","mat-raised-button","","color","primary",3,"appFieldPermissions","click"],["type","button","mat-raised-button","","color","primary",1,"ms-2",3,"appFieldPermissions","click"],[1,"shadow-none","bg-slate-200","rounded-md","mb-4"],[1,"py-2","px-4","flex","flex-row","items-center","font-normal","text-base"],[1,"inline-block","me-3"],[1,"px-4","py-2"]],template:function(o,n){1&o&&e.YNc(0,at,148,40,"div",0),2&o&&e.Q6J("ngIf",n.incident)},dependencies:[l.sg,l.O5,C.ey,f.KE,f.TO,N.Nt,U.gD,q.lW,q.RK,D.Hw,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,Me,l.uU,J.k],styles:["textarea[_ngcontent-%COMP%]{height:100px!important}"]}),r})()}];let ct=(()=>{var t;class r{}return(t=r).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[m.Bz.forChild(dt),m.Bz]}),r})();var ut=d(1186),lt=d(2524),mt=d(6208);let pt=(()=>{var t;class r{}return(t=r).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[u.U],imports:[l.ez,ct,ut.q,a.u5,a.UX,lt.D,mt.m]}),r})()},8499:(F,S,d)=>{d.d(S,{U:()=>g});var l=d(5861),m=d(6510),p=d(5879),a=d(7278);let g=(()=>{var _;class I{constructor(e){this.http=e}create(e){var u=this;return(0,l.Z)(function*(){return yield u.http.post(m.S.INCIDENTS.BASE_ENDPOINT,e)})()}findAll(e,u,Z,A,C,v,f,N){var U=this;return(0,l.Z)(function*(){const h=[{name:"page",value:e.toString()},{name:"pageSize",value:u.toString()}];return Z&&h.push({name:"search",value:Z}),A&&h.push({name:"status",value:A}),C&&h.push({name:"categoryId",value:C}),v&&h.push({name:"startCreatedOn",value:v.toISOString()}),f&&h.push({name:"endCreatedOn",value:f.toISOString()}),N&&h.push({name:"assignedGroupId",value:N}),yield U.http.get(m.S.INCIDENTS.BASE_ENDPOINT,h)})()}findOne(e){var u=this;return(0,l.Z)(function*(){return yield u.http.get(m.S.INCIDENTS.BY_ID(e))})()}update(e,u){var Z=this;return(0,l.Z)(function*(){return yield Z.http.patch(m.S.INCIDENTS.BY_ID(e),u)})()}remove(e){var u=this;return(0,l.Z)(function*(){yield u.http.delete(m.S.INCIDENTS.BY_ID(e))})()}findAllCategories(){var e=this;return(0,l.Z)(function*(){return yield e.http.get(m.S.INCIDENTS.CATEGORIES.BASE_ENDPOINT)})()}createComment(e){var u=this;return(0,l.Z)(function*(){return yield u.http.post(m.S.INCIDENTS.COMMENTS.BASE_ENDPOINT,e)})()}getNotificationFields(){var e=this;return(0,l.Z)(function*(){return yield e.http.get(m.S.INCIDENTS.NOTIFICATIONS.BASE_ENDPOINT)})()}}return(_=I).\u0275fac=function(e){return new(e||_)(p.LFG(a.v))},_.\u0275prov=p.Yz7({token:_,factory:_.\u0275fac}),I})()}}]);