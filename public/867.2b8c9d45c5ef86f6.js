"use strict";(self.webpackChunkandon_frontend=self.webpackChunkandon_frontend||[]).push([[867],{4808:(E,x,d)=>{d.d(x,{J:()=>f});var c=d(5861),u=d(6510),m=d(5879),r=d(7278);let f=(()=>{var _;class h{constructor(e){this.http=e}findAll(){var e=this;return(0,c.Z)(function*(){return yield e.http.get(u.S.GROUPS.BASE_ENDPOINT)})()}findOne(e){var l=this;return(0,c.Z)(function*(){return yield l.http.get(u.S.GROUPS.BY_ID(e))})()}}return(_=h).\u0275fac=function(e){return new(e||_)(m.LFG(r.v))},_.\u0275prov=m.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),h})()},8867:(E,x,d)=>{d.r(x),d.d(x,{IncidentsModule:()=>at});var c=d(6814),u=d(1303),m=d(5861),r=d(6223),f=function(t){return t.UNASSIGNED="Unassigned",t.ASSIGNED="Assigned",t.IN_PROGRESS="In progress",t.CLOSED="Closed",t.CANCEL="Cancel",t}(f||{});const _=Object.values(f);function h(t){switch(t){case f.UNASSIGNED:return"Sin asignar";case f.ASSIGNED:return"Asignado";case f.IN_PROGRESS:return"En progreso";case f.CLOSED:return"Cerrado";case f.CANCEL:return"Cancelado"}return""}var N=d(8693),e=d(5879),l=d(8499),A=d(9347),v=d(4808),T=d(3680),g=d(8034),I=d(5683),y=d(2032),U=d(8525),Z=d(5195),q=d(2296),F=d(617),b=d(1476),C=d(5313),D=d(3031);function L(t,s){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"B\xfasqueda inv\xe1lida"),e.qZA())}function Y(t,s){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Estado inv\xe1lido"),e.qZA())}function G(t,s){if(1&t&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.value)}}function M(t,s){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Categor\xeda inv\xe1lida"),e.qZA())}function B(t,s){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha inicial inv\xe1lida"),e.qZA())}function R(t,s){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha final inv\xe1lida"),e.qZA())}function k(t,s){if(1&t&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.name)}}function $(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"N\xfamero"),e.qZA())}const J=function(t){return["/","incidents",t]};function j(t,s){if(1&t&&(e.TgZ(0,"td",47)(1,"a",48),e._uU(2),e.qZA()()),2&t){const n=s.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,J,n.id)),e.xp6(1),e.Oqu(n.number)}}function z(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Empleado"),e.qZA())}function K(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.Oqu(n.employee)}}function V(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Descripci\xf3n"),e.qZA())}function H(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.Oqu(n.description)}}function W(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Estado"),e.qZA())}function X(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const n=s.$implicit,o=e.oxw();e.xp6(1),e.hij(" ",o.incidentStatusToSpanish(n.status)," ")}}function ee(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Categor\xeda"),e.qZA())}function te(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.Oqu(n.category.value)}}function ne(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"L\xednea de producci\xf3n"),e.qZA())}function ie(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.Oqu(n.productionLine.value)}}function oe(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Creado en"),e.qZA())}function se(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.ALo(2,"date"),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,n.createdOn,"d/M/yy, h:mm a")," ")}}function re(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Creado por"),e.qZA())}function ae(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,n.createdBy))}}function de(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Grupo asignado"),e.qZA())}function ce(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.hij(" ",n.assignedGroup?n.assignedGroup.name:""," ")}}function ue(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Asignado a"),e.qZA())}function le(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,n.assignedTo)," ")}}function me(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Cerrado por"),e.qZA())}function pe(t,s){if(1&t&&(e.TgZ(0,"td",47),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const n=s.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,n.closedBy))}}function _e(t,s){1&t&&(e.TgZ(0,"th",46),e._uU(1,"Eliminar"),e.qZA())}function ge(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"td",47)(1,"button",49),e.NdJ("click",function(){const a=e.CHM(n).$implicit,p=e.oxw();return e.KtG(p.openDeleteDialog(a.id))}),e.TgZ(2,"mat-icon"),e._uU(3,"close"),e.qZA()()()}}function fe(t,s){1&t&&e._UZ(0,"tr",50)}function he(t,s){1&t&&e._UZ(0,"tr",51)}function ve(t,s){1&t&&(e.TgZ(0,"p"),e._uU(1," Creado por: "),e.qZA())}function Ze(t,s){1&t&&(e.TgZ(0,"p"),e._uU(1,"Grupo asignado:"),e.qZA())}function Te(t,s){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.hij(" Asignado a: ",n.assignedTo," ")}}function Ie(t,s){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.hij(" Cerrado por: ",e.lcZ(2,1,n.closedBy)," ")}}function Ce(t,s){if(1&t&&(e.TgZ(0,"div",52)(1,"mat-card",53)(2,"mat-card-header",54)(3,"mat-card-subtitle"),e._uU(4),e.qZA(),e.TgZ(5,"mat-card-subtitle"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"mat-card-title"),e._uU(9),e.qZA()(),e.TgZ(10,"mat-card-content")(11,"p",55),e._uU(12),e.qZA(),e.TgZ(13,"p"),e._uU(14),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA(),e.TgZ(17,"p"),e._uU(18),e.qZA(),e.YNc(19,ve,2,0,"p",11),e.YNc(20,Ze,2,0,"p",11),e.YNc(21,Te,2,1,"p",11),e.YNc(22,Ie,3,3,"p",11),e.qZA()()()),2&t){const n=s.$implicit,o=e.oxw();e.Q6J("routerLink",e.VKq(15,J,n.id)),e.xp6(4),e.Oqu(n.number),e.xp6(2),e.hij(" ",e.xi3(7,12,n.createdOn,"d/M/yy, h:mm a"),""),e.xp6(3),e.Oqu(n.description),e.xp6(3),e.hij(" Estado: ",o.incidentStatusToSpanish(n.status)," "),e.xp6(2),e.hij("Empleado: ",n.employee,""),e.xp6(2),e.hij("Categor\xeda: ",n.category.value,""),e.xp6(2),e.hij("L\xednea de Producci\xf3n: ",n.productionLine.value,""),e.xp6(1),e.Q6J("ngIf",n.status==o.status.UNASSIGNED||n.status==o.status.CANCEL),e.xp6(1),e.Q6J("ngIf",n.status==o.status.ASSIGNED),e.xp6(1),e.Q6J("ngIf",n.status==o.status.IN_PROGRESS),e.xp6(1),e.Q6J("ngIf",n.status==o.status.CLOSED)}}const xe=function(){return["/","incidents","create"]},Ae=function(){return["/","incidents"]},P=function(){return[5,10,25,100]};let Se=(()=>{var t;class s{constructor(o,i,a,p,S){this.incidentsService=o,this.dialog=i,this.groupsService=a,this.route=p,this.router=S,this.status=f,this.incidentStatusToSpanish=h,this.incidents=[],this.categories=[],this.groups=[],this.displayedColumns=["number","employee","description","status","category","productionLine","createdOn","createdBy","assignedGroup","assignedTo","closedBy","delete"],this.filtersForm=new r.cw({search:new r.NI(""),status:new r.NI(""),categoryId:new r.NI(""),startCreatedOn:new r.NI(null),endCreatedOn:new r.NI(null),assignedGroupId:new r.NI("")}),this.page=0,this.pages=0,this.pageSize=25,this.length=0}ngOnInit(){var o=this;this.incidentsService.findAllCategories().then(i=>this.categories=i),this.groupsService.findAll().then(i=>this.groups=i),this.route.queryParams.subscribe(function(){var i=(0,m.Z)(function*(a){o.filtersForm.setValue({search:a.search??"",status:a.status??"",categoryId:a.categoryId??"",startCreatedOn:a.startCreatedOn?new Date(a.startCreatedOn):null,endCreatedOn:a.endCreatedOn?new Date(a.endCreatedOn):null,assignedGroupId:a.assignedGroupId??""}),yield o.getIncidents()});return function(a){return i.apply(this,arguments)}}())}getIncidents(){var o=this;return(0,m.Z)(function*(){if(o.filtersForm.valid){const i=o.filtersForm.value;if(null==i.startCreatedOn&&null==i.endCreatedOn||null!=i.startCreatedOn&&null!=i.endCreatedOn){o.router.navigate([],{queryParams:{search:""==i.search?void 0:i.search,status:""==i.status?void 0:i.status,categoryId:""==i.categoryId?void 0:i.categoryId,startCreatedOn:null==i.startCreatedOn?void 0:new Date(i.startCreatedOn),endCreatedOn:null==i.endCreatedOn?void 0:new Date(i.endCreatedOn),assignedGroupId:""==i.assignedGroupId?void 0:i.assignedGroupId}});const a=yield o.incidentsService.findAll(o.page+1,o.pageSize,""==i.search?void 0:i.search,""==i.status?void 0:i.status,""==i.categoryId?void 0:i.categoryId,null==i.startCreatedOn?void 0:i.startCreatedOn,null==i.endCreatedOn?void 0:i.endCreatedOn,""==i.assignedGroupId?void 0:i.assignedGroupId);o.incidents=a.incidents,o.page=a.page-1,o.pages=a.pages,o.length=a.length}}})()}changePage(o){var i=this;return(0,m.Z)(function*(){i.page=o.pageIndex,i.pageSize=o.pageSize,i.getIncidents()})()}openDeleteDialog(o){var i=this;this.dialog.open(N.F,{data:{cascade:!1}}).afterClosed().subscribe(function(){var p=(0,m.Z)(function*(S){S&&(yield i.incidentsService.remove(o),yield i.getIncidents())});return function(S){return p.apply(this,arguments)}}())}}return(t=s).\u0275fac=function(o){return new(o||t)(e.Y36(l.U),e.Y36(A.uw),e.Y36(v.J),e.Y36(u.gz),e.Y36(u.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-incidents"]],decls:116,vars:38,consts:[[1,"flex","flex-row","mb-5","px-2","items-center"],[1,"text-3xl","font-bold"],[1,"flex-auto"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"max-xl:hidden"],[1,"bg-white","p-3","rounded-md","shadow-md","mb-4"],[1,"flex","flex-row","flex-wrap",3,"submit"],[1,"mx-2","w-full","max-w-xs"],["appearance","outline",1,"w-full"],["matInput","","type","text",3,"formControl"],["mat-icon-button","","matSuffix","","type","submit"],[4,"ngIf"],[3,"formControl","selectionChange"],["value",""],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[3,"rangePicker"],["matStartDate","","placeholder","Fecha inicial",3,"formControl","dateChange"],["matEndDate","","placeholder","Fecha final",3,"formControl","dateChange"],["matIconSuffix","",3,"for"],["picker",""],[1,"mx-2","flex","items-center"],["mat-raised-button","","color","primary","type","button",3,"routerLink"],[1,"overflow-auto"],["mat-table","",3,"dataSource"],["matColumnDef","number"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","employee"],["matColumnDef","description"],["matColumnDef","status"],["matColumnDef","category"],["matColumnDef","productionLine"],["matColumnDef","createdOn"],["matColumnDef","createdBy"],["matColumnDef","assignedGroup"],["matColumnDef","assignedTo"],["matColumnDef","closedBy"],["matColumnDef","delete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","length","pageSize","pageIndex","page"],[1,"xl:hidden"],[1,"px-2","flex","flex-wrap","justify-around"],["class","!p-2 hover:cursor-pointer basis-1/3","style","min-width: 300px",3,"routerLink",4,"ngFor","ngForOf"],["showFirstLastButtons","",1,"!bg-transparent","mt-2",3,"pageSizeOptions","length","pageSize","pageIndex","page"],["mat-header-cell",""],["mat-cell",""],[1,"text-blue-500","hover:underline",3,"routerLink"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"!p-2","hover:cursor-pointer","basis-1/3",2,"min-width","300px",3,"routerLink"],[1,"hover:bg-red-100","active:bg-red-200",2,"height","240px"],[1,"mb-2"],[1,"text-red-600"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Incidentes"),e.qZA(),e._UZ(3,"div",2),e.TgZ(4,"button",3),e._uU(5," Crear Incidente "),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5)(8,"form",6),e.NdJ("submit",function(){return i.getIncidents()}),e.TgZ(9,"div",7)(10,"p"),e._uU(11,"Buscar"),e.qZA(),e.TgZ(12,"mat-form-field",8),e._UZ(13,"input",9),e.TgZ(14,"button",10)(15,"mat-icon"),e._uU(16,"search"),e.qZA()(),e.YNc(17,L,2,0,"mat-error",11),e.qZA()(),e.TgZ(18,"div",7)(19,"p"),e._uU(20,"Estado"),e.qZA(),e.TgZ(21,"mat-form-field",8)(22,"mat-select",12),e.NdJ("selectionChange",function(){return i.getIncidents()}),e.TgZ(23,"mat-option",13),e._uU(24,"Todos"),e.qZA(),e.TgZ(25,"mat-option",14),e._uU(26,"Sin asignar"),e.qZA(),e.TgZ(27,"mat-option",14),e._uU(28,"Asignado"),e.qZA(),e.TgZ(29,"mat-option",14),e._uU(30,"En progreso"),e.qZA(),e.TgZ(31,"mat-option",14),e._uU(32,"Cerrado"),e.qZA(),e.TgZ(33,"mat-option",14),e._uU(34,"Cancelado"),e.qZA()(),e.YNc(35,Y,2,0,"mat-error",11),e.qZA()(),e.TgZ(36,"div",7)(37,"p"),e._uU(38,"Categor\xeda"),e.qZA(),e.TgZ(39,"mat-form-field",8)(40,"mat-select",12),e.NdJ("selectionChange",function(){return i.getIncidents()}),e.TgZ(41,"mat-option",13),e._uU(42,"Todas"),e.qZA(),e.YNc(43,G,2,2,"mat-option",15),e.qZA(),e.YNc(44,M,2,0,"mat-error",11),e.qZA()(),e.TgZ(45,"div",7)(46,"p"),e._uU(47,"Creado entre"),e.qZA(),e.TgZ(48,"mat-form-field",8)(49,"mat-date-range-input",16)(50,"input",17),e.NdJ("dateChange",function(){return i.getIncidents()}),e.qZA(),e.TgZ(51,"input",18),e.NdJ("dateChange",function(){return i.getIncidents()}),e.qZA()(),e.TgZ(52,"mat-hint"),e._uU(53,"DD/MM/AAAA - DD/MM/AAAA"),e.qZA(),e._UZ(54,"mat-datepicker-toggle",19)(55,"mat-date-range-picker",null,20),e.YNc(57,B,2,0,"mat-error",11),e.YNc(58,R,2,0,"mat-error",11),e.qZA()(),e.TgZ(59,"div",7)(60,"p"),e._uU(61,"Grupo"),e.qZA(),e.TgZ(62,"mat-form-field",8)(63,"mat-select",12),e.NdJ("selectionChange",function(){return i.getIncidents()}),e.TgZ(64,"mat-option",13),e._uU(65,"Todos"),e.qZA(),e.YNc(66,k,2,2,"mat-option",15),e.qZA()()(),e.TgZ(67,"div",21)(68,"button",22),e._uU(69," Limpiar "),e.qZA()()()(),e.TgZ(70,"div",5)(71,"div",23)(72,"table",24),e.ynx(73,25),e.YNc(74,$,2,0,"th",26),e.YNc(75,j,3,4,"td",27),e.BQk(),e.ynx(76,28),e.YNc(77,z,2,0,"th",26),e.YNc(78,K,2,1,"td",27),e.BQk(),e.ynx(79,29),e.YNc(80,V,2,0,"th",26),e.YNc(81,H,2,1,"td",27),e.BQk(),e.ynx(82,30),e.YNc(83,W,2,0,"th",26),e.YNc(84,X,2,1,"td",27),e.BQk(),e.ynx(85,31),e.YNc(86,ee,2,0,"th",26),e.YNc(87,te,2,1,"td",27),e.BQk(),e.ynx(88,32),e.YNc(89,ne,2,0,"th",26),e.YNc(90,ie,2,1,"td",27),e.BQk(),e.ynx(91,33),e.YNc(92,oe,2,0,"th",26),e.YNc(93,se,3,4,"td",27),e.BQk(),e.ynx(94,34),e.YNc(95,re,2,0,"th",26),e.YNc(96,ae,3,3,"td",27),e.BQk(),e.ynx(97,35),e.YNc(98,de,2,0,"th",26),e.YNc(99,ce,2,1,"td",27),e.BQk(),e.ynx(100,36),e.YNc(101,ue,2,0,"th",26),e.YNc(102,le,3,3,"td",27),e.BQk(),e.ynx(103,37),e.YNc(104,me,2,0,"th",26),e.YNc(105,pe,3,3,"td",27),e.BQk(),e.ynx(106,38),e.YNc(107,_e,2,0,"th",26),e.YNc(108,ge,4,0,"td",27),e.BQk(),e.YNc(109,fe,1,0,"tr",39),e.YNc(110,he,1,0,"tr",40),e.qZA()(),e.TgZ(111,"mat-paginator",41),e.NdJ("page",function(p){return i.changePage(p)}),e.qZA()()(),e.TgZ(112,"div",42)(113,"div",43),e.YNc(114,Ce,23,17,"div",44),e.qZA(),e.TgZ(115,"mat-paginator",45),e.NdJ("page",function(p){return i.changePage(p)}),e.qZA()()),2&o){const a=e.MAs(56);e.xp6(4),e.Q6J("routerLink",e.DdM(34,xe)),e.xp6(9),e.Q6J("formControl",i.filtersForm.controls.search),e.xp6(4),e.Q6J("ngIf",i.filtersForm.controls.search.invalid),e.xp6(5),e.Q6J("formControl",i.filtersForm.controls.status),e.xp6(3),e.Q6J("value",i.status.UNASSIGNED),e.xp6(2),e.Q6J("value",i.status.ASSIGNED),e.xp6(2),e.Q6J("value",i.status.IN_PROGRESS),e.xp6(2),e.Q6J("value",i.status.CLOSED),e.xp6(2),e.Q6J("value",i.status.CANCEL),e.xp6(2),e.Q6J("ngIf",i.filtersForm.controls.status.invalid),e.xp6(5),e.Q6J("formControl",i.filtersForm.controls.categoryId),e.xp6(3),e.Q6J("ngForOf",i.categories),e.xp6(1),e.Q6J("ngIf",i.filtersForm.controls.categoryId.invalid),e.xp6(5),e.Q6J("rangePicker",a),e.xp6(1),e.Q6J("formControl",i.filtersForm.controls.startCreatedOn),e.xp6(1),e.Q6J("formControl",i.filtersForm.controls.endCreatedOn),e.xp6(3),e.Q6J("for",a),e.xp6(3),e.Q6J("ngIf",i.filtersForm.controls.startCreatedOn.invalid),e.xp6(1),e.Q6J("ngIf",i.filtersForm.controls.endCreatedOn.invalid),e.xp6(5),e.Q6J("formControl",i.filtersForm.controls.assignedGroupId),e.xp6(3),e.Q6J("ngForOf",i.groups),e.xp6(2),e.Q6J("routerLink",e.DdM(35,Ae)),e.xp6(4),e.Q6J("dataSource",i.incidents),e.xp6(37),e.Q6J("matHeaderRowDef",i.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",i.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(36,P))("length",i.length)("pageSize",i.pageSize)("pageIndex",i.page),e.xp6(3),e.Q6J("ngForOf",i.incidents),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(37,P))("length",i.length)("pageSize",i.pageSize)("pageIndex",i.page)}},dependencies:[c.sg,c.O5,u.rH,T.ey,g.nW,g.wx,g.zY,g.By,g._g,I.KE,I.bx,I.TO,I.R9,y.Nt,U.gD,Z.a8,Z.dn,Z.dk,Z.$j,Z.n5,q.lW,q.RK,F.Hw,b.NW,C.BZ,C.fO,C.as,C.w1,C.Dz,C.nj,C.ge,C.ev,C.XQ,C.Gk,r._Y,r.Fj,r.JJ,r.JL,r.F,r.oH,c.uU,D.k]}),s})();var w=d(9627);function Ne(t,s){if(1&t&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.value)}}function ye(t,s){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Categor\xeda inv\xe1lida"),e.qZA())}function Ue(t,s){if(1&t&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.value)}}function qe(t,s){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"L\xednea de producci\xf3n inv\xe1lida"),e.qZA())}function Ee(t,s){1&t&&(e.TgZ(0,"mat-error"),e._uU(1,"Empleado inv\xe1lido"),e.qZA())}function Oe(t,s){1&t&&(e.TgZ(0,"mat-error",19),e._uU(1,"Descripci\xf3n inv\xe1lida"),e.qZA())}let Fe=(()=>{var t;class s{constructor(o,i,a){this.incidentsService=o,this.productionLinesService=i,this.router=a,this.categories=[],this.productionLines=[],this.createIncidentForm=new r.cw({category:new r.NI("",[r.kI.required,r.kI.maxLength(64)]),productionLine:new r.NI("",[r.kI.required,r.kI.maxLength(64)]),employee:new r.NI("",[r.kI.required,r.kI.maxLength(128)]),description:new r.NI("",[r.kI.required])})}ngOnInit(){var o=this;return(0,m.Z)(function*(){o.categories=yield o.incidentsService.findAllCategories(),o.productionLines=yield o.productionLinesService.findAll()})()}create(){var o=this;return(0,m.Z)(function*(){if(o.createIncidentForm.valid){const i=o.createIncidentForm.value,a=yield o.incidentsService.create({category:i.category,productionLine:i.productionLine,employee:i.employee,description:i.description});a&&o.router.navigate(["incidents",a.id])}})()}}return(t=s).\u0275fac=function(o){return new(o||t)(e.Y36(l.U),e.Y36(w.F),e.Y36(u.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-create-incident"]],decls:37,vars:8,consts:[[1,"flex","flex-row","mb-5","px-2","items-center"],[1,"text-3xl","font-bold"],[3,"formGroup","submit"],[1,"bg-white","py-3","px-2","rounded-md","shadow-md","mb-4"],[1,"flex","flex-row","flex-wrap"],[1,"flex-1","mx-2"],["appearance","outline",1,"w-full"],["formControlName","category"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","productionLine"],[1,"flex-1","mx-2","flex-aux"],["matInput","","formControlName","employee"],[1,"mx-2"],["matInput","","formControlName","description"],["class","resize-none",4,"ngIf"],[1,"flex","flex-row-reverse","me-4"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"value"],[1,"resize-none"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Crear Incidente"),e.qZA()(),e.TgZ(3,"form",2),e.NdJ("submit",function(){return i.create()}),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"p"),e._uU(8,"Categor\xeda"),e.qZA(),e.TgZ(9,"mat-form-field",6)(10,"mat-select",7),e.YNc(11,Ne,2,2,"mat-option",8),e.qZA(),e.YNc(12,ye,2,0,"mat-error",9),e.qZA()(),e.TgZ(13,"div",5)(14,"p"),e._uU(15,"L\xednea de Producci\xf3n"),e.qZA(),e.TgZ(16,"mat-form-field",6)(17,"mat-select",10),e.YNc(18,Ue,2,2,"mat-option",8),e.qZA(),e.YNc(19,qe,2,0,"mat-error",9),e.qZA()()(),e.TgZ(20,"div",4)(21,"div",11)(22,"p"),e._uU(23,"Empleado"),e.qZA(),e.TgZ(24,"mat-form-field",6),e._UZ(25,"input",12),e.YNc(26,Ee,2,0,"mat-error",9),e.qZA()(),e._UZ(27,"div",11),e.qZA(),e.TgZ(28,"div",13)(29,"p"),e._uU(30,"Descripci\xf3n"),e.qZA(),e.TgZ(31,"mat-form-field",6),e._UZ(32,"textarea",14),e.YNc(33,Oe,2,0,"mat-error",15),e.qZA()()(),e.TgZ(34,"div",16)(35,"button",17),e._uU(36," Crear "),e.qZA()()()),2&o&&(e.xp6(3),e.Q6J("formGroup",i.createIncidentForm),e.xp6(8),e.Q6J("ngForOf",i.categories),e.xp6(1),e.Q6J("ngIf",i.createIncidentForm.controls.category.invalid),e.xp6(6),e.Q6J("ngForOf",i.productionLines),e.xp6(1),e.Q6J("ngIf",i.createIncidentForm.controls.productionLine.invalid),e.xp6(7),e.Q6J("ngIf",i.createIncidentForm.controls.employee.invalid),e.xp6(7),e.Q6J("ngIf",i.createIncidentForm.controls.description.invalid),e.xp6(2),e.Q6J("disabled",i.createIncidentForm.invalid))},dependencies:[c.sg,c.O5,T.ey,I.KE,I.TO,y.Nt,U.gD,q.lW,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u],styles:["textarea[_ngcontent-%COMP%]{height:100px!important}.flex-aux[_ngcontent-%COMP%]{width:100%;min-width:212px}"]}),s})();var Q=function(t){return t.P0="P0",t.P1="P1",t.P2="P2",t.P3="P3",t}(Q||{});const De=Object.values(Q);var Je=d(8080),Pe=d(2939),we=d(9309);function Qe(t,s){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const n=s.$implicit,o=e.oxw(2);e.Q6J("value",n),e.xp6(1),e.Oqu(o.incidentStatusToSpanish(n))}}function be(t,s){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.value)}}function Le(t,s){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.value)}}function Ye(t,s){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.name)}}function Ge(t,s){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(e.lcZ(2,2,n))}}function Me(t,s){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.value)}}function Be(t,s){if(1&t&&(e.TgZ(0,"mat-option",39),e._uU(1),e.qZA()),2&t){const n=s.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(n)}}function Re(t,s){if(1&t&&(e.TgZ(0,"div",23)(1,"div",24)(2,"mat-icon",25),e._uU(3,"schedule"),e.qZA(),e.TgZ(4,"div"),e._uU(5,"Tiempo de paro"),e.qZA()(),e.TgZ(6,"div",26)(7,"p"),e._uU(8),e.qZA()()()),2&t){const n=e.oxw(2);e.xp6(8),e.lnq(" ",0==n.closeTime.days?"":1==n.closeTime.days?n.closeTime.days+" d\xeda, ":n.closeTime.days+" d\xedas, "," ",0==n.closeTime.hours?"":1==n.closeTime.hours?n.closeTime.hours+" hora, ":n.closeTime.hours+" horas, "," ",1==n.closeTime.minutes?n.closeTime.minutes+" minuto":n.closeTime.minutes+" minutos"," ")}}function ke(t,s){if(1&t&&(e.TgZ(0,"div",23)(1,"div",24)(2,"mat-icon",25),e._uU(3,"account_circle"),e.qZA(),e.TgZ(4,"div"),e._uU(5,"Cerrado por"),e.qZA()(),e.TgZ(6,"div",26)(7,"p"),e._uU(8),e.ALo(9,"fullName"),e.qZA()()()),2&t){const n=e.oxw(2);e.xp6(8),e.Oqu(e.lcZ(9,1,n.incident.closedBy))}}function $e(t,s){if(1&t&&(e.TgZ(0,"div",23)(1,"div",24)(2,"mat-icon",25),e._uU(3,"event"),e.qZA(),e.TgZ(4,"div"),e._uU(5,"Cerrado en"),e.qZA()(),e.TgZ(6,"div",26)(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA()()()),2&t){const n=e.oxw(2);e.xp6(8),e.Oqu(e.xi3(9,1,n.incident.closedOn,"d/M/yy, h:mm a"))}}function je(t,s){1&t&&(e.TgZ(0,"div",40)(1,"p"),e._uU(2,"Tiempo de resoluci\xf3n"),e.qZA(),e.TgZ(3,"mat-form-field",7)(4,"mat-select",41)(5,"mat-option",39),e._uU(6,"15 minutos"),e.qZA(),e.TgZ(7,"mat-option",39),e._uU(8,"30 minutos"),e.qZA(),e.TgZ(9,"mat-option",39),e._uU(10,"45 minutos"),e.qZA(),e.TgZ(11,"mat-option",39),e._uU(12,"1 hora"),e.qZA(),e.TgZ(13,"mat-option",39),e._uU(14,"1 hora 15 minutos"),e.qZA(),e.TgZ(15,"mat-option",39),e._uU(16,"1 hora 30 minutos"),e.qZA(),e.TgZ(17,"mat-option",39),e._uU(18,"1 hora 45 minutos"),e.qZA(),e.TgZ(19,"mat-option",39),e._uU(20,"2 horas"),e.qZA()(),e.TgZ(21,"mat-error"),e._uU(22,"Tiempo de resoluci\xf3n inv\xe1lido"),e.qZA()(),e.TgZ(23,"p"),e._uU(24,"Soluci\xf3n propuesta"),e.qZA(),e.TgZ(25,"mat-form-field",7),e._UZ(26,"textarea",42),e.TgZ(27,"mat-error"),e._uU(28,"Soluci\xf3n propuesta inv\xe1lida"),e.qZA()()()),2&t&&(e.Q6J("appFieldPermissions","resolutionTimeInMinutes"),e.xp6(5),e.Q6J("value",15),e.xp6(2),e.Q6J("value",30),e.xp6(2),e.Q6J("value",45),e.xp6(2),e.Q6J("value",60),e.xp6(2),e.Q6J("value",75),e.xp6(2),e.Q6J("value",90),e.xp6(2),e.Q6J("value",105),e.xp6(2),e.Q6J("value",120))}function ze(t,s){if(1&t&&(e.TgZ(0,"div",40)(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"mat-form-field",7),e._UZ(4,"textarea",43),e.TgZ(5,"mat-error"),e._uU(6),e.qZA()()()),2&t){const n=e.oxw(2);e.Q6J("appFieldPermissions","closeNotes"),e.xp6(2),e.hij(" Notas de ",n.incidentForm.controls.status.value==n.incidentSingleStatus.CLOSED?"cierre":"cancelaci\xf3n"," "),e.xp6(4),e.hij("Notas de ",n.incidentForm.controls.status.value==n.incidentSingleStatus.CLOSED?"cierre":"cancelaci\xf3n"," inv\xe1lidas")}}function Ke(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return i.incidentForm.controls.status.setValue(i.incidentSingleStatus.ASSIGNED),e.KtG(i.statusChanged())}),e._uU(1," Asignar "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnAssign")}function Ve(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return i.incidentForm.controls.status.setValue(i.incidentSingleStatus.IN_PROGRESS),e.KtG(i.statusChanged())}),e._uU(1," En progreso "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnInProgress")}function He(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return i.incidentForm.controls.status.setValue(i.incidentSingleStatus.CLOSED),e.KtG(i.statusChanged())}),e._uU(1," Cerrar "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnClose")}function We(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return i.incidentForm.controls.status.setValue(i.incidentSingleStatus.IN_PROGRESS),e.KtG(i.statusChanged())}),e._uU(1," Abrir "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnOpen")}function Xe(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return i.incidentForm.controls.status.setValue(i.incidentSingleStatus.CANCEL),e.KtG(i.statusChanged())}),e._uU(1," Cancelar "),e.qZA()}2&t&&e.Q6J("appFieldPermissions","btnCancel")}function et(t,s){if(1&t&&(e.TgZ(0,"div",46)(1,"div")(2,"div",47)(3,"mat-icon",48),e._uU(4,"person"),e.qZA(),e.TgZ(5,"div"),e._uU(6),e.ALo(7,"fullName"),e.qZA(),e._UZ(8,"div",3),e.TgZ(9,"div"),e._uU(10),e.ALo(11,"date"),e.qZA()()(),e.TgZ(12,"div",49),e._uU(13),e.qZA()()),2&t){const n=s.$implicit;e.xp6(6),e.hij(" ",e.lcZ(7,3,n.createdBy)," "),e.xp6(4),e.Oqu(e.xi3(11,5,n.createdOn,"d/M/yy, h:mm a")),e.xp6(3),e.hij(" ",n.value," ")}}function tt(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div")(1,"div",1)(2,"h1",2),e._uU(3),e.qZA(),e._UZ(4,"div",3),e.qZA(),e.TgZ(5,"form",4),e.NdJ("submit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.update())}),e.TgZ(6,"div",5)(7,"div",6)(8,"p"),e._uU(9,"Descripci\xf3n"),e.qZA(),e.TgZ(10,"mat-form-field",7),e._UZ(11,"textarea",8),e.TgZ(12,"mat-error"),e._uU(13,"Descripci\xf3n inv\xe1lida"),e.qZA()()(),e.TgZ(14,"div",9)(15,"div",10)(16,"p"),e._uU(17,"Estado"),e.qZA(),e.TgZ(18,"mat-form-field",7)(19,"mat-select",11),e.NdJ("selectionChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.statusChanged())}),e.YNc(20,Qe,2,2,"mat-option",12),e.qZA(),e.TgZ(21,"mat-error"),e._uU(22,"Estado inv\xe1lido"),e.qZA()()(),e.TgZ(23,"div",10)(24,"p"),e._uU(25,"Categor\xeda"),e.qZA(),e.TgZ(26,"mat-form-field",7)(27,"mat-select",13),e.YNc(28,be,2,2,"mat-option",12),e.qZA(),e.TgZ(29,"mat-error"),e._uU(30,"Categor\xeda inv\xe1lida"),e.qZA()()()(),e.TgZ(31,"div",9)(32,"div",10)(33,"p"),e._uU(34,"Linea de producci\xf3n"),e.qZA(),e.TgZ(35,"mat-form-field",7)(36,"mat-select",14),e.YNc(37,Le,2,2,"mat-option",12),e.qZA(),e.TgZ(38,"mat-error"),e._uU(39,"Linea de producci\xf3n inv\xe1lida"),e.qZA()()(),e.TgZ(40,"div",10)(41,"p"),e._uU(42,"Grupo de apoyo"),e.qZA(),e.TgZ(43,"mat-form-field",7)(44,"mat-select",15),e.NdJ("selectionChange",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.assignedGroupChanged())}),e.TgZ(45,"mat-option",16),e._uU(46,"-- Sin grupo de apoyo --"),e.qZA(),e.YNc(47,Ye,2,2,"mat-option",12),e.qZA(),e.TgZ(48,"mat-error"),e._uU(49,"Grupo de apoyo inv\xe1lido"),e.qZA()()()(),e.TgZ(50,"div",9)(51,"div",10)(52,"p"),e._uU(53,"Asignado a"),e.qZA(),e.TgZ(54,"mat-form-field",7)(55,"mat-select",17)(56,"mat-option",16),e._uU(57,"-- Sin persona asignada --"),e.qZA(),e.YNc(58,Ge,3,4,"mat-option",12),e.qZA(),e.TgZ(59,"mat-error"),e._uU(60,"Asignado inv\xe1lido"),e.qZA()()(),e.TgZ(61,"div",10)(62,"p"),e._uU(63,"M\xe1quina"),e.qZA(),e.TgZ(64,"mat-form-field",7)(65,"mat-select",18)(66,"mat-option",16),e._uU(67,"-- Sin m\xe1quina --"),e.qZA(),e.YNc(68,Me,2,2,"mat-option",12),e.qZA(),e.TgZ(69,"mat-error"),e._uU(70,"M\xe1quina inv\xe1lida"),e.qZA()()()(),e.TgZ(71,"div",9)(72,"div",10)(73,"p"),e._uU(74,"Prioridad"),e.qZA(),e.TgZ(75,"mat-form-field",7)(76,"mat-select",19)(77,"mat-option",16),e._uU(78,"-- Sin prioridad --"),e.qZA(),e.YNc(79,Be,2,2,"mat-option",12),e.qZA(),e.TgZ(80,"mat-error"),e._uU(81,"Prioridad inv\xe1lida"),e.qZA()()(),e.TgZ(82,"div",20),e._UZ(83,"div",21),e.qZA()()(),e.TgZ(84,"div",22)(85,"div",23)(86,"div",24)(87,"mat-icon",25),e._uU(88,"schedule"),e.qZA(),e.TgZ(89,"div"),e._uU(90,"Tiempo de asignaci\xf3n"),e.qZA()(),e.TgZ(91,"div",26)(92,"p"),e._uU(93),e.qZA()()(),e.YNc(94,Re,9,3,"div",27),e.TgZ(95,"div",23)(96,"div",24)(97,"mat-icon",25),e._uU(98,"person"),e.qZA(),e.TgZ(99,"div"),e._uU(100,"Empleado"),e.qZA()(),e.TgZ(101,"div",26)(102,"p"),e._uU(103),e.qZA()()(),e.TgZ(104,"div",23)(105,"div",24)(106,"mat-icon",25),e._uU(107,"account_circle"),e.qZA(),e.TgZ(108,"div"),e._uU(109,"Creado por"),e.qZA()(),e.TgZ(110,"div",26)(111,"p"),e._uU(112),e.ALo(113,"fullName"),e.qZA()()(),e.TgZ(114,"div",23)(115,"div",24)(116,"mat-icon",25),e._uU(117,"event"),e.qZA(),e.TgZ(118,"div"),e._uU(119,"Creado en"),e.qZA()(),e.TgZ(120,"div",26)(121,"p"),e._uU(122),e.ALo(123,"date"),e.qZA()()(),e.YNc(124,ke,10,3,"div",27),e.YNc(125,$e,10,4,"div",27),e.qZA(),e.YNc(126,je,29,9,"div",28),e.YNc(127,ze,7,3,"div",28),e.TgZ(128,"div",29),e.YNc(129,Ke,2,1,"button",30),e.YNc(130,Ve,2,1,"button",30),e.YNc(131,He,2,1,"button",30),e.YNc(132,We,2,1,"button",30),e.YNc(133,Xe,2,1,"button",31),e.TgZ(134,"button",32),e._uU(135," Guardar "),e.qZA()()(),e.TgZ(136,"form",33),e.NdJ("submit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.comment())}),e.TgZ(137,"h2",34),e._uU(138,"Comentarios"),e.qZA(),e.YNc(139,et,14,8,"div",35),e.TgZ(140,"div",26)(141,"mat-form-field",36),e._UZ(142,"input",37),e.TgZ(143,"mat-error"),e._uU(144,"Comentario inv\xe1lido"),e.qZA()(),e.TgZ(145,"button",38)(146,"mat-icon"),e._uU(147,"send"),e.qZA()()()()()}if(2&t){const n=e.oxw();e.xp6(3),e.hij("Incidente: ",n.incident.number,""),e.xp6(2),e.Q6J("formGroup",n.incidentForm),e.xp6(2),e.Q6J("appFieldPermissions","description"),e.xp6(8),e.Q6J("appFieldPermissions","status"),e.xp6(5),e.Q6J("ngForOf",n.incidentStatus),e.xp6(3),e.Q6J("appFieldPermissions","category"),e.xp6(5),e.Q6J("ngForOf",n.incidentCategories),e.xp6(4),e.Q6J("appFieldPermissions","productionLine"),e.xp6(5),e.Q6J("ngForOf",n.productionLines),e.xp6(3),e.Q6J("appFieldPermissions","assignedGroup"),e.xp6(7),e.Q6J("ngForOf",n.groups),e.xp6(4),e.Q6J("appFieldPermissions","assignedTo"),e.xp6(7),e.Q6J("ngForOf",n.users),e.xp6(3),e.Q6J("appFieldPermissions","machine"),e.xp6(7),e.Q6J("ngForOf",n.machines),e.xp6(4),e.Q6J("appFieldPermissions","priority"),e.xp6(7),e.Q6J("ngForOf",n.IncidentPriorities),e.xp6(14),e.lnq(" ",0==n.inProgressTime.days?"":1==n.inProgressTime.days?n.inProgressTime.days+" d\xeda, ":n.inProgressTime.days+" d\xedas, "," ",0==n.inProgressTime.hours?"":1==n.inProgressTime.hours?n.inProgressTime.hours+" hora, ":n.inProgressTime.hours+" horas, "," ",1==n.inProgressTime.minutes?n.inProgressTime.minutes+" minuto":n.inProgressTime.minutes+" minutos"," "),e.xp6(1),e.Q6J("ngIf",n.incident.status==n.incidentSingleStatus.IN_PROGRESS||n.incident.status==n.incidentSingleStatus.CLOSED),e.xp6(9),e.Oqu(n.incident.employee),e.xp6(9),e.Oqu(e.lcZ(113,35,n.incident.createdBy)),e.xp6(10),e.Oqu(e.xi3(123,37,n.incident.createdOn,"d/M/yy, h:mm a")),e.xp6(2),e.Q6J("ngIf",n.incident.status==n.incidentSingleStatus.CLOSED),e.xp6(1),e.Q6J("ngIf",n.incident.status==n.incidentSingleStatus.CLOSED),e.xp6(1),e.Q6J("ngIf",n.incidentForm.controls.status.value==n.incidentSingleStatus.IN_PROGRESS||n.incidentForm.controls.status.value==n.incidentSingleStatus.CLOSED),e.xp6(1),e.Q6J("ngIf",n.incidentForm.controls.status.value==n.incidentSingleStatus.CLOSED||n.incidentForm.controls.status.value==n.incidentSingleStatus.CANCEL),e.xp6(2),e.Q6J("ngIf",n.incidentForm.controls.status.value==n.incidentSingleStatus.UNASSIGNED),e.xp6(1),e.Q6J("ngIf",n.incidentForm.controls.status.value==n.incidentSingleStatus.ASSIGNED),e.xp6(1),e.Q6J("ngIf",n.incidentForm.controls.status.value==n.incidentSingleStatus.IN_PROGRESS),e.xp6(1),e.Q6J("ngIf",n.incidentForm.controls.status.value==n.incidentSingleStatus.CLOSED||n.incidentForm.controls.status.value==n.incidentSingleStatus.CANCEL),e.xp6(1),e.Q6J("ngIf",n.incidentForm.controls.status.value!=n.incidentSingleStatus.CANCEL),e.xp6(3),e.Q6J("formGroup",n.commentForm),e.xp6(3),e.Q6J("ngForOf",n.incident.comments)}}const nt=[{path:"",component:Se},{path:"create",component:Fe},{path:":id",component:(()=>{var t;class s{constructor(o,i,a,p,S,O,dt){this.incidentsService=o,this.productionLinesService=i,this.groupsService=a,this.machinesService=p,this.snackBar=S,this.route=O,this.router=dt,this.incidentStatus=_,this.incidentCategories=[],this.productionLines=[],this.machines=[],this.groups=[],this.users=[],this.IncidentPriorities=De,this.inProgressTime={days:0,hours:0,minutes:0},this.closeTime={days:0,hours:0,minutes:0},this.incidentStatusToSpanish=h,this.incidentSingleStatus=f,this.incidentForm=new r.cw({description:new r.NI("",[r.kI.required]),status:new r.NI(f.UNASSIGNED,[r.kI.required]),categoryId:new r.NI("",[r.kI.required]),productionLineId:new r.NI("",[r.kI.required]),assignedGroupId:new r.NI(""),assignedToId:new r.NI({value:"",disabled:!0}),machineId:new r.NI(""),priority:new r.NI(""),resolutionTimeInMinutes:new r.NI(""),proposedSolution:new r.NI(""),closeNotes:new r.NI("")}),this.commentForm=new r.cw({value:new r.NI("",[r.kI.required])})}ngOnInit(){var o=this;return(0,m.Z)(function*(){yield o.getIncident(),o.incidentsService.findAllCategories().then(i=>o.incidentCategories=i),o.productionLinesService.findAll().then(i=>o.productionLines=i),o.machinesService.findAll().then(i=>o.machines=i),o.groupsService.findAll().then(i=>o.groups=i)})()}calculateTimeDifference(o,i){const a=i?i-o:o;return{days:Math.floor(a/864e5),hours:Math.floor(a%864e5/36e5),minutes:Math.floor(a%36e5/6e4)}}setTimes(){clearInterval(this.inProgressInterval),clearInterval(this.closedInterval),this.incident.inProgressOn?this.inProgressTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),new Date(this.incident.inProgressOn).getTime()):(this.inProgressTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),(new Date).getTime()),this.inProgressInterval=setInterval(()=>{this.inProgressTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),(new Date).getTime())},1e4)),this.incident.status!=this.incidentSingleStatus.CLOSED&&this.incident.status!=this.incidentSingleStatus.CANCEL||!this.incident.closedOn?(this.closeTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),(new Date).getTime()),this.closedInterval=setInterval(()=>{this.closeTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),(new Date).getTime())},1e4)):this.closeTime=this.calculateTimeDifference(new Date(this.incident.createdOn).getTime(),new Date(this.incident.closedOn).getTime())}getIncident(){var o=this;return(0,m.Z)(function*(){try{o.incident=yield o.incidentsService.findOne(o.route.snapshot.params.id),o.incidentForm.setValue({status:o.incident.status,description:o.incident.description,categoryId:o.incident.category.id,productionLineId:o.incident.productionLine.id,assignedGroupId:o.incident.assignedGroup?o.incident.assignedGroup.id:"",assignedToId:o.incident.assignedTo?o.incident.assignedTo.id:"",machineId:o.incident.machine?o.incident.machine.id:"",priority:o.incident.priority??"",resolutionTimeInMinutes:o.incident.resolutionTimeInMinutes??NaN,proposedSolution:o.incident.proposedSolution??"",closeNotes:o.incident.closeNotes?o.incident.closeNotes:""}),o.setTimes(),o.statusChanged(),o.assignedGroupChanged(!1)}catch{o.router.navigate(["/","errors","404"])}})()}statusChanged(){var o=this;return(0,m.Z)(function*(){const i=o.incidentForm.controls.status.value,a=o.incidentForm.controls;i==o.incidentSingleStatus.ASSIGNED||i==o.incidentSingleStatus.IN_PROGRESS||i==o.incidentSingleStatus.CLOSED?a.assignedGroupId.setValidators(r.kI.required):a.assignedGroupId.clearValidators(),i==o.incidentSingleStatus.IN_PROGRESS||i==o.incidentSingleStatus.CLOSED?(a.resolutionTimeInMinutes.addValidators([r.kI.required,r.kI.pattern(/^\d*$/)]),a.proposedSolution.addValidators(r.kI.required),a.assignedToId.addValidators(r.kI.required)):(a.resolutionTimeInMinutes.clearValidators(),a.proposedSolution.clearValidators(),a.assignedToId.clearValidators()),i==o.incidentSingleStatus.CLOSED||i==o.incidentSingleStatus.CANCEL?a.closeNotes.setValidators(r.kI.required):a.closeNotes.clearValidators();for(const p of Object.keys(a))a[p].updateValueAndValidity()})()}assignedGroupChanged(o=!0){var i=this;return(0,m.Z)(function*(){const a=i.incidentForm.controls.assignedGroupId,p=i.incidentForm.controls;""!=a.value?(i.users=(yield i.groupsService.findOne(a.value)).users,o&&p.assignedToId.setValue(""),p.assignedToId.enable()):(p.assignedToId.setValue(""),p.assignedToId.disable())})()}update(){var o=this;return(0,m.Z)(function*(){if(o.incidentForm.valid){const i=o.incidentForm.value;let a={description:i.description,status:i.status,categoryId:i.categoryId,productionLineId:i.productionLineId,assignedGroupId:""==i.assignedGroupId?void 0:i.assignedGroupId,assignedToId:""==i.assignedToId?void 0:i.assignedToId,machineId:""==i.machineId?void 0:i.machineId,priority:""==i.priority?void 0:i.priority};(i.status==o.incidentSingleStatus.IN_PROGRESS||i.status==o.incidentSingleStatus.CLOSED)&&(a={resolutionTimeInMinutes:""==i.resolutionTimeInMinutes?void 0:i.resolutionTimeInMinutes,proposedSolution:""==i.proposedSolution?void 0:i.proposedSolution,...a}),(i.status==o.incidentSingleStatus.CLOSED||i.status==o.incidentSingleStatus.CANCEL)&&(a={closeNotes:""==i.closeNotes?void 0:i.closeNotes,...a}),yield o.incidentsService.update(o.incident.id,a),yield o.getIncident(),o.snackBar.open("Incidente actualizado",void 0,{duration:2e3,horizontalPosition:"end",verticalPosition:"bottom"})}})()}comment(){var o=this;return(0,m.Z)(function*(){if(o.commentForm.valid){const i=o.commentForm.value;yield o.incidentsService.createComment({value:i.value,incidentId:o.incident.id}),o.commentForm.reset(),yield o.getIncident()}})()}}return(t=s).\u0275fac=function(o){return new(o||t)(e.Y36(l.U),e.Y36(w.F),e.Y36(v.J),e.Y36(Je.M),e.Y36(Pe.ux),e.Y36(u.gz),e.Y36(u.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-incident"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"flex","flex-row","mb-5","px-2","items-center"],[1,"text-3xl","font-bold"],[1,"flex-auto"],[1,"mb-4",3,"formGroup","submit"],[1,"bg-white","p-3","rounded-md","shadow-md","mb-4"],[1,"px-2",3,"appFieldPermissions"],["appearance","outline",1,"w-full"],["matInput","","formControlName","description"],[1,"flex","flex-row","flex-wrap"],[1,"px-2","flex-auto",3,"appFieldPermissions"],["formControlName","status",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","categoryId"],["formControlName","productionLineId"],["formControlName","assignedGroupId",3,"selectionChange"],["value",""],["formControlName","assignedToId"],["formControlName","machineId"],["formControlName","priority"],[1,"px-2","flex-auto"],[2,"width","212px"],[1,"bg-white","py-3","rounded-md","shadow-md","mb-4","px-5"],[1,"flex","flex-row","my-2"],[1,"flex","flex-row","items-center","w-52"],[1,"me-3"],[1,"flex","flex-row","items-center"],["class","flex flex-row my-2",4,"ngIf"],["class","bg-white py-3 px-5 rounded-md shadow-md mb-4",3,"appFieldPermissions",4,"ngIf"],[1,"flex","flex-row","justify-end"],["type","button","mat-raised-button","","color","primary",3,"appFieldPermissions","click",4,"ngIf"],["class","ms-2","type","button","mat-raised-button","","color","primary",3,"appFieldPermissions","click",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"ms-2"],[1,"bg-white","p-3","rounded-md","shadow-md","mb-4",3,"formGroup","submit"],[1,"font-bold","text-xl","mb-4"],["class","shadow-none bg-slate-200 rounded-md mb-4",4,"ngFor","ngForOf"],["appearance","outline",1,"w-full","me-2"],["matInput","","placeholder","Agregar nuevo comentario","formControlName","value"],["mat-icon-button","","color","primary","type","submit",1,"mb-6"],[3,"value"],[1,"bg-white","py-3","px-5","rounded-md","shadow-md","mb-4",3,"appFieldPermissions"],["formControlName","resolutionTimeInMinutes"],["matInput","","formControlName","proposedSolution"],["matInput","","formControlName","closeNotes"],["type","button","mat-raised-button","","color","primary",3,"appFieldPermissions","click"],["type","button","mat-raised-button","","color","primary",1,"ms-2",3,"appFieldPermissions","click"],[1,"shadow-none","bg-slate-200","rounded-md","mb-4"],[1,"py-2","px-4","flex","flex-row","items-center","font-normal","text-base"],[1,"inline-block","me-3"],[1,"px-4","py-2"]],template:function(o,i){1&o&&e.YNc(0,tt,148,40,"div",0),2&o&&e.Q6J("ngIf",i.incident)},dependencies:[c.sg,c.O5,T.ey,I.KE,I.TO,y.Nt,U.gD,q.lW,q.RK,F.Hw,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,we.S,c.uU,D.k],styles:["textarea[_ngcontent-%COMP%]{height:100px!important}"]}),s})()}];let it=(()=>{var t;class s{}return(t=s).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.Bz.forChild(nt),u.Bz]}),s})();var ot=d(2898),st=d(2524),rt=d(6208);let at=(()=>{var t;class s{}return(t=s).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[l.U],imports:[c.ez,it,ot.q,r.u5,r.UX,st.D,rt.m]}),s})()},8499:(E,x,d)=>{d.d(x,{U:()=>f});var c=d(5861),u=d(6510),m=d(5879),r=d(7278);let f=(()=>{var _;class h{constructor(e){this.http=e}create(e){var l=this;return(0,c.Z)(function*(){return yield l.http.post(u.S.INCIDENTS.BASE_ENDPOINT,e)})()}findAll(e,l,A,v,T,g,I,y){var U=this;return(0,c.Z)(function*(){const Z=[{name:"page",value:e.toString()},{name:"pageSize",value:l.toString()}];return A&&Z.push({name:"search",value:A}),v&&Z.push({name:"status",value:v}),T&&Z.push({name:"categoryId",value:T}),g&&Z.push({name:"startCreatedOn",value:g.toISOString()}),I&&Z.push({name:"endCreatedOn",value:I.toISOString()}),y&&Z.push({name:"assignedGroupId",value:y}),yield U.http.get(u.S.INCIDENTS.BASE_ENDPOINT,Z)})()}findOne(e){var l=this;return(0,c.Z)(function*(){return yield l.http.get(u.S.INCIDENTS.BY_ID(e))})()}update(e,l){var A=this;return(0,c.Z)(function*(){return yield A.http.patch(u.S.INCIDENTS.BY_ID(e),l)})()}remove(e){var l=this;return(0,c.Z)(function*(){yield l.http.delete(u.S.INCIDENTS.BY_ID(e))})()}findAllCategories(){var e=this;return(0,c.Z)(function*(){return yield e.http.get(u.S.INCIDENTS.CATEGORIES.BASE_ENDPOINT)})()}createComment(e){var l=this;return(0,c.Z)(function*(){return yield l.http.post(u.S.INCIDENTS.COMMENTS.BASE_ENDPOINT,e)})()}getNotificationFields(){var e=this;return(0,c.Z)(function*(){return yield e.http.get(u.S.INCIDENTS.NOTIFICATIONS.BASE_ENDPOINT)})()}}return(_=h).\u0275fac=function(e){return new(e||_)(m.LFG(r.v))},_.\u0275prov=m.Yz7({token:_,factory:_.\u0275fac}),h})()},9309:(E,x,d)=>{d.d(x,{S:()=>N});var c=d(8645),u=d(9773),m=d(7398),r=d(4221);const f=(0,r.ZF)("permissions"),_=(0,r.P1)(f,e=>e.permissions);var h=d(5879);let N=(()=>{var e;class l{set appFieldPermissions(v){this.permissions$.pipe((0,u.R)(this.destroy$),(0,m.U)(T=>{const g=T?.permissions?.fields[v];g?this.setFieldVisibilityAndEditability(g.canRead,g.canWrite):this.hideAndMakeReadonly()}))}constructor(v,T,g){this.el=v,this.renderer=T,this.store=g,this.permissions$=this.store.select(_),this.destroy$=new c.x}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}hideAndMakeReadonly(){this.renderer.addClass(this.el.nativeElement,"hidden"),this.renderer.addClass(this.el.nativeElement,"readonly")}setFieldVisibilityAndEditability(v,T){const g=this.el.nativeElement;v?this.renderer.removeClass(g,"hidden"):this.renderer.addClass(g,"hidden"),T?this.renderer.removeClass(this.el.nativeElement,"readonly"):(this.renderer.addClass(this.el.nativeElement,"readonly"),this.renderer.setStyle(this.el.nativeElement,"background-color","#f5f5f5"))}}return(e=l).\u0275fac=function(v){return new(v||e)(h.Y36(h.SBq),h.Y36(h.Qsj),h.Y36(r.yh))},e.\u0275dir=h.lG2({type:e,selectors:[["","appFieldPermissions",""]],inputs:{appFieldPermissions:"appFieldPermissions"}}),l})()}}]);