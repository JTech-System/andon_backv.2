"use strict";(self.webpackChunkandon_frontend=self.webpackChunkandon_frontend||[]).push([[300],{300:(K,A,r)=>{r.d(A,{I:()=>B});var d=r(5861),t=r(5879),c=r(5313),g=r(1476),p=r(9347),m=r(6223),M=r(7921),y=r(7398),T=r(7278);let C=(()=>{var n;class l{constructor(e){this.http=e}findAll(e){var a=this;return(0,d.Z)(function*(){return yield a.http.get(e)})()}removeRelation(e,a,i){var s=this;return(0,d.Z)(function*(){return yield s.http.delete(i(e),a)})()}addRelation(e,a,i){var s=this;return(0,d.Z)(function*(){return yield s.http.put(i(e),a)})()}}return(n=l).\u0275fac=function(e){return new(e||n)(t.LFG(T.v))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),l})();var f=r(6814),v=r(4630),w=r(3680),h=r(5683),D=r(2032),x=r(2296),R=r(5940);function S(n,l){1&n&&t._UZ(0,"mat-spinner")}function b(n,l){if(1&n&&(t.TgZ(0,"div",6),t.YNc(1,S,1,0,"mat-spinner",5),t.qZA()),2&n){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.isLoadingResults)}}function N(n,l){if(1&n&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&n){const o=l.$implicit,e=t.oxw(3);t.Q6J("value",o[e.local_data.m2mData.rel_primary_col]),t.xp6(1),t.hij(" ",o[e.local_data.m2mData.rel_primary_col]," ")}}function U(n,l){if(1&n){const o=t.EpF();t.TgZ(0,"form",null,7)(2,"div",8)(3,"div",9)(4,"mat-label"),t._uU(5),t.qZA(),t.TgZ(6,"mat-form-field",10),t._UZ(7,"input",11),t.TgZ(8,"mat-autocomplete",null,12),t.YNc(10,N,2,2,"mat-option",13),t.ALo(11,"async"),t.qZA()()()(),t.TgZ(12,"button",14),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.doAdd())}),t._uU(13," Agregar "),t.qZA(),t.TgZ(14,"button",15),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.closeDialog())}),t._uU(15," Cancelar "),t.qZA()()}if(2&n){const o=t.MAs(1),e=t.MAs(9),a=t.oxw(2);t.xp6(5),t.Oqu(a.local_data.m2mData.title),t.xp6(2),t.Q6J("formControl",a.filterControl)("matAutocomplete",e),t.xp6(3),t.Q6J("ngForOf",t.lcZ(11,5,a.searchfilteredOptions)),t.xp6(2),t.Q6J("disabled",!o.valid)}}function J(n,l){if(1&n&&(t.TgZ(0,"mat-dialog-content",3),t.YNc(1,b,2,1,"div",4),t.YNc(2,U,16,7,"form",5),t.qZA()),2&n){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.isLoadingResults),t.xp6(1),t.Q6J("ngIf",!o.isLoadingResults)}}function Y(n,l){if(1&n){const o=t.EpF();t.TgZ(0,"div",17)(1,"p"),t._uU(2," Desea eliminar este registro"),t.TgZ(3,"span",18),t._uU(4),t.qZA(),t._uU(5," ? "),t.qZA()(),t.TgZ(6,"div",19)(7,"button",20),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.doDelete())}),t._uU(8," Eliminar "),t.qZA(),t.TgZ(9,"button",21),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.closeDialog())}),t._uU(10,"Cancelar"),t.qZA()()}if(2&n){const o=t.oxw();t.xp6(4),t.Oqu(o.local_data.name)}}let I=(()=>{var n;class l{constructor(e,a,i){this.dialogRef=e,this.data=a,this.m2mService=i,this.filterControl=new m.NI(""),this.relation_endpoint="",this.searchoption=[],this.isLoadingResults=!0,this.local_data={...a},this.action=this.local_data.action,this.relation_endpoint=this.local_data.m2mData.relation_endpoint}doAdd(){const e=this.searchoption.findIndex(a=>a[this.local_data.m2mData.rel_primary_col]==this.filterControl.value);this.local_data.relation_id=this.searchoption[e].id,this.local_data.relation=this.filterControl.value,this.dialogRef.close({event:this.action,data:this.local_data})}doDelete(){this.searchoption.findIndex(a=>a[this.local_data.m2mData.rel_primary_col]==this.local_data.relation),this.local_data.relation_id=this.local_data.relation_id,this.local_data.relation=this.local_data.relation,this.dialogRef.close({event:this.action,data:this.local_data})}closeDialog(){this.dialogRef.close({event:"Cancel"})}ngOnInit(){var e=this;return(0,d.Z)(function*(){const a=yield e.m2mService.findAll(e.relation_endpoint);a&&(e.isLoadingResults=!1,e.searchoption=a),e.searchfilteredOptions=e.filterControl.valueChanges.pipe((0,M.O)(""),(0,y.U)(i=>e._searchfilter(i||"")))})()}_searchfilter(e){const a=e.toLowerCase();return this.searchoption.filter(i=>i[this.local_data.m2mData.rel_primary_col].toString().toLowerCase().includes(a))}}return(n=l).\u0275fac=function(e){return new(e||n)(t.Y36(p.so),t.Y36(p.WI,8),t.Y36(C))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dialog-content"]],decls:6,vars:3,consts:[["mat-dialog-title","",1,"f-w-500","m-b-24"],["style","max-width: 100wv",4,"ngIf","ngIfElse"],["elseTemplate",""],[2,"max-width","100wv"],["class","example-loading-shade",4,"ngIf"],[4,"ngIf"],[1,"example-loading-shade"],["userForm","ngForm"],[1,"row"],[1,"col-12"],["appearance","outline",1,"w-100"],["type","text","placeholder","Buscar","aria-label","Relation","matInput","",3,"formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","mat-flat-button","","color","primary",3,"disabled","click"],["mat-stroked-button","","color","warn",1,"m-l-8",3,"click"],[3,"value"],[1,"p-x-24","m-b-15"],[1,"f-w-600"],["mat-dialog-actions","",1,"p-x-24","p-b-24"],["mat-button","","mat-flat-button","","color","warn",3,"click"],["mat-button","",1,"m-l-8",3,"click"]],template:function(e,a){if(1&e&&(t.TgZ(0,"h2",0)(1,"strong"),t._uU(2),t.qZA()(),t.YNc(3,J,3,2,"mat-dialog-content",1),t.YNc(4,Y,11,1,"ng-template",null,2,t.W1O)),2&e){const i=t.MAs(5);t.xp6(2),t.Oqu("Add"==a.action?"Agregar "+a.local_data.m2mData.titleSingle:"Eliminar"),t.xp6(1),t.Q6J("ngIf","Delete"!==a.action)("ngIfElse",i)}},dependencies:[f.sg,f.O5,v.XC,w.ey,v.ZL,h.KE,h.hX,D.Nt,x.lW,R.Ou,p.uh,p.xY,p.H8,m._Y,m.Fj,m.JJ,m.JL,m.F,m.oH,f.Ov],encapsulation:2}),l})();var O=r(617),Z=r(3566);function k(n,l){if(1&n&&(t.TgZ(0,"th",18),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const o=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,o.m2mData.titleSingle)," ")}}function F(n,l){if(1&n&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&n){const o=l.$implicit;t.xp6(1),t.hij(" ",o.relation," ")}}function Q(n,l){1&n&&(t.TgZ(0,"th",20),t._uU(1," Acciones "),t.qZA())}function E(n,l){if(1&n){const o=t.EpF();t.TgZ(0,"td",21)(1,"a",22),t.NdJ("click",function(){const i=t.CHM(o).$implicit,s=t.oxw();return t.KtG(s.openDialog("Delete",i))}),t.TgZ(2,"mat-icon",23),t._uU(3,"delete"),t.qZA()()()}}function L(n,l){1&n&&t._UZ(0,"tr",24)}function H(n,l){1&n&&t._UZ(0,"tr",25)}const G=function(){return[5,10,20]};let B=(()=>{var n;class l{constructor(e,a,i){this.dialog=e,this.cdRef=a,this.m2mService=i,this.table=Object.create(null),this.m2mData={title:"Relations",titleSingle:"Relations",parent:"Relations",parent_table:"relations",relation:"Relations",rel_primary_col:"id",relation_endpoint:"",display_cols:["id"],updateRelationEndpoint:s=>"string",data:[]},this.relationshipChanged=new t.vpe,this.displayedColumns=["relation","action"],this.dataSource=new c.by(this.m2mData.data),this.paginator=Object.create(null),this.dataSource=new c.by(this.m2mData.data),this.m2mData.data.length>0&&(this.dataSource.data=this.m2mData.data)}ngAfterViewInit(){this.m2mData.data.length>0&&(this.dataSource=new c.by(this.m2mData.data)),this.dataSource.paginator=this.paginator}applyFilter(e){this.dataSource.filter=e.trim().toLowerCase()}openDialog(e,a){a.action=e,a.m2mData=this.m2mData,this.dialog.open(I,{data:a}).afterClosed().subscribe(s=>{"Add"===s.event?this.addRowData(s.data):"Delete"===s.event&&this.deleteRowData(s.data)})}addRowData(e){var a=this;return(0,d.Z)(function*(){let i={};if(!a.dataSource.data.some(u=>u.relation==e.relation)){a.dataSource.data.unshift({parent:a.m2mData.parent,relation:e.relation,relation_id:e.relation_id}),a.dataSource.data=[...a.dataSource.data];const u=a.dataSource.data.map(z=>z.relation_id);i[a.m2mData.relation]=u,a.cdRef.detectChanges(),a.emitRelationshipChange(u),yield a.m2mService.addRelation(a.m2mData.parent,i,a.m2mData.updateRelationEndpoint)}})()}deleteRowData(e){var a=this;return(0,d.Z)(function*(){let i={};const s=a.dataSource.data.findIndex(_=>_.relation===e.relation);i[a.m2mData.relation]=[a.dataSource.data[s].relation_id],yield a.m2mService.removeRelation(a.m2mData.parent,i,a.m2mData.updateRelationEndpoint),-1!==s&&(a.dataSource.data.splice(s,1),a.cdRef.detectChanges(),a.dataSource.data=a.dataSource.data.filter(_=>_.relation!==e.relation))})()}emitRelationshipChange(e){this.relationshipChanged.emit(e)}}return(n=l).\u0275fac=function(e){return new(e||n)(t.Y36(p.uw),t.Y36(t.sBO),t.Y36(C))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-m2m"]],viewQuery:function(e,a){if(1&e&&(t.Gf(c.BZ,7),t.Gf(g.NW,7)),2&e){let i;t.iGM(i=t.CRH())&&(a.table=i.first),t.iGM(i=t.CRH())&&(a.paginator=i.first)}},inputs:{m2mData:"m2mData"},outputs:{relationshipChanged:"relationshipChanged"},decls:23,vars:9,consts:[[1,"row","justify-content-between"],[1,"col-lg-4"],["appearance","outline",1,"w-100","hide-hint"],["matInput","",3,"placeholder","keyup"],["matSuffix",""],[1,"col-lg-4","d-flex","align-items-center","justify-content-end"],["type","button","mat-flat-button","","color","primary",3,"click"],[1,"table-responsive"],["mat-table","","matSort","","matSortActive","createdOn","matSortDisableClear","","matSortDirection","desc",1,"example-table",3,"dataSource"],["matColumnDef","relation"],["mat-header-cell","","mat-sort-header","","class","f-w-600 mat-subtitle-1 f-s-16",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","action"],["mat-header-cell","","class","f-s-16 f-w-600",4,"matHeaderCellDef"],["mat-cell","","class","action-link",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"pageSizeOptions","showFirstLastButtons","hidePageSize"],["mat-header-cell","","mat-sort-header","",1,"f-w-600","mat-subtitle-1","f-s-16"],["mat-cell",""],["mat-header-cell","",1,"f-s-16","f-w-600"],["mat-cell","",1,"action-link"],[1,"m-r-10","cursor-pointer",3,"click"],[1,"mat-18"],["mat-header-row",""],["mat-row",""]],template:function(e,a){1&e&&(t.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"mat-form-field",2)(4,"input",3),t.NdJ("keyup",function(s){return a.applyFilter(s.target.value)}),t.qZA(),t.TgZ(5,"mat-icon",4)(6,"mat-icon"),t._uU(7,"search"),t.qZA()()()(),t.TgZ(8,"div",5)(9,"button",6),t.NdJ("click",function(){return a.openDialog("Add",{})}),t._uU(10),t.qZA()()()(),t.TgZ(11,"div")(12,"div",7)(13,"table",8),t.ynx(14,9),t.YNc(15,k,3,3,"th",10),t.YNc(16,F,2,1,"td",11),t.BQk(),t.ynx(17,12),t.YNc(18,Q,2,0,"th",13),t.YNc(19,E,4,0,"td",14),t.BQk(),t.YNc(20,L,1,0,"tr",15),t.YNc(21,H,1,0,"tr",16),t.qZA(),t._UZ(22,"mat-paginator",17),t.qZA()()),2&e&&(t.xp6(4),t.MGl("placeholder","Buscar ",a.m2mData.title,""),t.xp6(6),t.hij(" Agregar ",a.m2mData.titleSingle," "),t.xp6(3),t.Q6J("dataSource",a.dataSource),t.xp6(7),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(8,G))("showFirstLastButtons",!1)("hidePageSize",!0))},dependencies:[h.KE,h.R9,D.Nt,x.lW,O.Hw,g.NW,Z.YE,Z.nU,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,f.rS],styles:[".img-bg-m2m-icon[_ngcontent-%COMP%]{background-image:url(robots-03.2d3caddef6f94e3e.png);background-size:50px;background-repeat:no-repeat;background-position:left center;left:15px;position:absolute!important;min-height:150px;z-index:1000}"]}),l})()}}]);